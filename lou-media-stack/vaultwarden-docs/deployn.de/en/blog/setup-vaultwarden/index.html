<!DOCTYPE html><html lang="en" class="light dark:dark scroll-smooth"> 
<!-- Mirrored from deployn.de/en/blog/setup-vaultwarden/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 18 Jul 2025 17:41:09 GMT -->
<head><!-- Global Metadata --><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="theme-color" content="#2797b3"><meta name="generator" content="Astro v5.9.4"><!-- Favicon --><link rel="icon" href="https://deployn.de/favicon.ico" sizes="48x48"><link rel="icon" href="https://deployn.de/favicon.svg" sizes="any" type="image/svg+xml"><link rel="apple-touch-icon" href="https://deployn.de/apple-touch-icon-180x180.png"><link rel="manifest" href="https://deployn.de/site.webmanifest"><link rel="sitemap" href="https://deployn.de/sitemap-index.xml"><!-- hreflang Tags --><link rel="alternate" hreflang="de" href="https://deployn.de/de/blog/setup-vaultwarden/"><link rel="alternate" hreflang="en" href="index.html"><link rel="alternate" hreflang="x-default" href="https://deployn.de/blog/setup-vaultwarden/"><title>Self-hosting Vaultwarden: Step-by-Step Guide with Docker, Caddy, and Fail2Ban</title><link rel="canonical" href="index.html"><meta name="description" content="Host your own password manager, Vaultwarden, securely and efficiently. Install Vaultwarden as a Docker container and secure it with Fail2Ban."><meta name="robots" content="index, follow"><meta property="og:title" content="Self-hosting Vaultwarden: Step-by-Step Guide with Docker, Caddy, and Fail2Ban"><meta property="og:type" content="website"><meta property="og:image" content="https://deployn.de/_astro/image.DfNhu_Dn_Z1YY4AA.webp"><meta property="og:url" content="index.html"><meta property="og:description" content="Host your own password manager, Vaultwarden, securely and efficiently. Install Vaultwarden as a Docker container and secure it with Fail2Ban."><meta property="og:locale" content="en"><meta property="og:site_name" content="Deployn"><meta property="og:image:url" content="https://deployn.de/_astro/image.DfNhu_Dn_Z1YY4AA.webp"><meta property="og:image:type" content="image/webp"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="947"><meta property="og:image:alt" content="Deployn Cover Image"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content="@deployn_de"><meta name="twitter:title" content="Self-hosting Vaultwarden: Step-by-Step Guide with Docker, Caddy, and Fail2Ban"><meta name="twitter:image" content="https://deployn.de/_astro/image.DfNhu_Dn_Z1YY4AA.webp"><meta name="twitter:image:alt" content="Deployn Cover Image"><meta name="twitter:description" content="Host your own password manager, Vaultwarden, securely and efficiently. Install Vaultwarden as a Docker container and secure it with Fail2Ban."><meta name="twitter:creator" content="@deployn_de">  <script type="application/ld+json">
      {
        "@context": "https://schema.org",
        "@type": "BlogPosting",
        "headline": "Self-hosting Vaultwarden: Step-by-Step Guide with Docker, Caddy, and Fail2Ban",
        "image": "/_astro/image.DfNhu_Dn_Z1YY4AA.webp",
        "datePublished": "Wed Apr 30 2025 00:00:00 GMT+0000 (Coordinated Universal Time)",
        "author": {
          "@type": "Person",
          "name": "Jewgeni Lewash"
        },
        "inLanguage": "en",
        "keywords": ["docker", "password", "synology", "tutorial", "vaultwarden"],
        "isPartOf": {
            "@type": "Blog",
            "@id": "https://deployn.de/en/blog/",
            "name": "Deployn Blog"
        }
      }
    </script> <script type="application/ld+json">
        [{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blog","item":"https://deployn.de/en/blog/"},{"@type":"ListItem","position":2,"name":"Homeserver","item":"https://deployn.de/en/blog/category/homeserver/"},{"@type":"ListItem","position":3,"name":"Self-hosting Vaultwarden: Step-by-Step Guide with Docker, Caddy, and Fail2Ban","image":"/_astro/image.DfNhu_Dn_Z1YY4AA.webp"}]}
        ]
    </script> <meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><script type="module" src="https://deployn.de/_astro/ClientRouter.astro_astro_type_script_index_0_lang.r9EoUwFA.js"></script><script defer data-domain="deployn.de" src="https://plausible.deployn.de/js/script.js"></script><style>@keyframes astroFadeInOut{0%{opacity:1}to{opacity:0}}@keyframes astroFadeIn{0%{opacity:0;mix-blend-mode:plus-lighter}to{opacity:1;mix-blend-mode:plus-lighter}}@keyframes astroFadeOut{0%{opacity:1;mix-blend-mode:plus-lighter}to{opacity:0;mix-blend-mode:plus-lighter}}@keyframes astroSlideFromRight{0%{transform:translate(100%)}}@keyframes astroSlideFromLeft{0%{transform:translate(-100%)}}@keyframes astroSlideToRight{to{transform:translate(100%)}}@keyframes astroSlideToLeft{to{transform:translate(-100%)}}@media (prefers-reduced-motion){::view-transition-group(*),::view-transition-old(*),::view-transition-new(*){animation:none!important}[data-astro-transition-scope]{animation:none!important}}
</style>
<link rel="stylesheet" href="https://deployn.de/_astro/about.CoBJKJTl.css">
<style>.share-button[data-astro-cid-xiyysuza]{display:inline-flex;align-items:center;justify-content:center;padding:.5rem;border-radius:.25rem;transition:background-color .2s}.toc-current[data-astro-cid-ymbpksfa]{color:var(--color-secondary-600)}.dark[data-astro-cid-ymbpksfa] .toc-current[data-astro-cid-ymbpksfa]{color:var(--color-secondary-400)}.comentario-root{@apply dark:text-gray-300;}.comentario-root .comentario-card .comentario-subtitle a{@apply dark:text-gray-200;}.comentario-card{@apply overflow-scroll;}.comentario-card-body{@apply max-h-40 overflow-auto lg:max-h-60;}.comentario-card-body p{@apply break-words;}.comentario-card-body pre{@apply overflow-auto;}.comentario-root .comentario-card .comentario-card-body pre{@apply dark:bg-gray-800;}.comentario-root .comentario-toolbar,.comentario-root .comentario-comment-editor-footer{@apply dark:bg-primary-950;}.comentario-root .comentario-btn-link{@apply dark:text-danger-800;}.comentario-root .comentario-profile-bar{@apply dark:bg-secondary-900;}.comentario-footer a{@apply hidden;}
</style><script type="module" src="https://deployn.de/_astro/page.MtyO9NnE.js"></script><style>[data-astro-transition-scope="astro-efioaj37-1"] { view-transition-name: Homeserver; }</style><style>[data-astro-transition-scope="astro-kz7txu5a-2"] { view-transition-name: Self-hosting_20Vaultwarden_3a_20Step-by-Step_20Guide_20with_20Docker_2c_20Caddy_2c_20and_20Fail2Ban; }</style><style>[data-astro-transition-scope="astro-zjltrpfb-3"] { view-transition-name: Self-hosting_20Vaultwarden_3a_20Step-by-Step_20Guide_20with_20Docker_2c_20Caddy_2c_20and_20Fail2Ban_20hero_20image; }</style></head> <body class="flex min-h-screen flex-col pb-16 antialiased md:pb-0"> <a href="#main-content" class="skip-link" aria-label="Skip to main content" data-astro-cid-hoe5mouk> Skip to main content </a>  <div class="relative"> <header class="sticky top-0 z-40 hidden w-full border-b border-gray-100/50 bg-white/90 backdrop-blur-lg md:block dark:border-slate-700/30 dark:bg-slate-900/85"> <div class="mx-auto flex max-w-screen-xl items-center justify-between px-6 py-4"> <a href="https://deployn.de/en/" class="hover:text-primary-600 dark:hover:text-primary-300 text-xl font-bold tracking-tight text-gray-900 transition-all duration-300 hover:opacity-80 dark:text-white"> Deployn </a> <nav class="flex items-center gap-6 lg:gap-8"> <a class="block rounded-lg px-4 py-2 font-medium text-gray-700 transition-colors duration-300 hover:bg-gray-100 dark:text-gray-100 dark:hover:bg-slate-600 rounded-md px-2 py-1 font-medium text-gray-700 transition-colors duration-150 hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-slate-700/50" href="https://deployn.de/" data-astro-cid-mbqdmgin> Home </a> <a class="block rounded-lg px-4 py-2 font-medium text-gray-700 transition-colors duration-300 hover:bg-gray-100 dark:text-gray-100 dark:hover:bg-slate-600 rounded-md px-2 py-1 font-medium text-gray-700 transition-colors duration-150 hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-slate-700/50" href="https://deployn.de/blog/" data-astro-cid-mbqdmgin> Blog </a> <a class="block rounded-lg px-4 py-2 font-medium text-gray-700 transition-colors duration-300 hover:bg-gray-100 dark:text-gray-100 dark:hover:bg-slate-600 rounded-md px-2 py-1 font-medium text-gray-700 transition-colors duration-150 hover:bg-gray-100 dark:text-gray-200 dark:hover:bg-slate-700/50" href="https://deployn.de/about/" data-astro-cid-mbqdmgin> About </a>  <div class="flex items-center gap-3 pl-2 lg:gap-4"> <div x-data="{
				theme: localStorage.theme || 'system',
				updateDocumentClassTheme: function() {
					if (localStorage.theme === 'dark' || (!('theme' in localStorage) &#38;&#38; window.matchMedia('(prefers-color-scheme: dark)').matches)) {
						document.documentElement.classList.add('dark');
					} else {
						document.documentElement.classList.remove('dark');
					}
				},
				switchTheme: function (newValue) {
					if (newValue == 'dark') {
						localStorage.theme = 'dark';
					} else if (newValue == 'light') {
						localStorage.theme = 'light';
					} else {
						localStorage.removeItem('theme');
					}
					this.updateDocumentClassTheme();
				},
				toggleTheme: function () {
					if (this.theme === 'light') {
						this.theme = 'dark';
					} else if (this.theme === 'dark') {
						this.theme = 'light';
					} else {
						this.theme = 'dark';
					}
					this.switchTheme(this.theme);
				}
			}" aria-label="Toggle Dark/Light Mode" id="theme-selector" class="flex items-center justify-center" x-init="updateDocumentClassTheme()" x-model="theme" @change="switchTheme($event.target.value)" data-astro-cid-lgn464si> <div class="hidden items-center justify-center p-4 md:flex" data-astro-cid-lgn464si> <button :class="{'bg-gray-200': theme === 'light', 'bg-slate-700': theme === 'dark'}" class="theme-toggle-button hover:ring-primary-400/50 relative inline-flex h-10 w-20 items-center justify-center rounded-full shadow-sm transition-colors hover:ring-2 focus:outline-none" @click="toggleTheme()" :aria-checked="theme === 'dark'" role="switch" data-astro-cid-lgn464si> <span :class="{'translate-x-5': theme === 'dark', '-translate-x-5': theme === 'light'}" class="theme-toggle-thumb inline-flex h-8 w-8 transform items-center justify-center rounded-full bg-white shadow-md transition-transform dark:bg-slate-800" data-astro-cid-lgn464si> <span class="theme-icon-light" x-show="theme === 'light'" data-astro-cid-lgn464si>ðŸŒž</span> <span class="theme-icon-dark" x-show="theme === 'dark'" data-astro-cid-lgn464si>ðŸŒœ</span> <span class="theme-icon-system" x-show="theme === 'system'" data-astro-cid-lgn464si>ðŸŒ“</span> </span> </button> </div> <button @click="toggleTheme()" class="flex h-6 w-6 items-center justify-center md:hidden" aria-label="Toggle theme" data-astro-cid-lgn464si> <span x-show="theme === 'light'" class="block" data-astro-cid-lgn464si>ðŸŒž</span> <span x-show="theme === 'dark'" class="block" data-astro-cid-lgn464si>ðŸŒœ</span> <span x-show="theme === 'system'" class="block" data-astro-cid-lgn464si>ðŸŒ“</span> </button> </div>  <div class="h-4 w-px bg-gray-300 dark:bg-gray-700"></div> <script type="module" src="https://deployn.de/_astro/LanguageSelector.astro_astro_type_script_index_0_lang.CyFn7z68.js"></script> <!-- Desktop Version --><select aria-label="Change language" class="hidden cursor-pointer rounded-md px-4 py-2 text-lg shadow-md focus-visible:outline-none dark:bg-stone-800 dark:text-stone-50 md:block" x-data="dropdownData" @change="changePage($event)"> <option value="/de/blog/setup-vaultwarden/"> DE </option><option value="/en/blog/setup-vaultwarden/" selected> EN </option> </select> <!-- Mobile Version --> <button x-data="dropdownData" @click="toggleLanguage" class="block h-6 w-6 items-center justify-center text-base font-medium md:hidden" aria-label="Toggle language"> <span x-text="currentLocale.toUpperCase()"></span> </button> </div> </nav> </div> </header> <div id="mobile-backdrop" class="fixed inset-0 z-30 hidden bg-black/40 opacity-0 backdrop-blur-sm transition-opacity duration-300 md:hidden" aria-hidden="true"></div> <div id="mobile-menu-panel" class="fixed inset-x-0 bottom-0 z-40 overflow-hidden rounded-t-2xl border-t border-gray-200/50 bg-white shadow-xl transition-transform duration-300 ease-out md:hidden dark:border-slate-700/20 dark:bg-slate-900 translate-y-full" style="max-height: calc(80vh - 64px);" aria-modal="true" role="dialog" aria-hidden="true"> <div class="overflow-y-auto p-4 pb-16"> <nav class="flex flex-col gap-1"> <div class="mobile-nav-item"> <div class="flex items-center justify-between"> <a href="https://deployn.de/en/" class="flex-grow rounded-md px-3 py-2.5 text-base font-medium text-gray-700 transition-colors duration-150 hover:bg-gray-100 active:bg-gray-200 dark:text-slate-200 dark:hover:bg-slate-700/50 dark:active:bg-slate-700 pl-4" data-close-menu="true"> Home </a>  </div>  </div><div class="mobile-nav-item"> <div class="flex items-center justify-between"> <a href="https://deployn.de/en/blog/" class="flex-grow rounded-md px-3 py-2.5 text-base font-medium text-gray-700 transition-colors duration-150 hover:bg-gray-100 active:bg-gray-200 dark:text-slate-200 dark:hover:bg-slate-700/50 dark:active:bg-slate-700 pl-4" data-close-menu="true"> Blog </a>  </div>  </div><div class="mobile-nav-item"> <div class="flex items-center justify-between"> <a href="https://deployn.de/en/about/" class="flex-grow rounded-md px-3 py-2.5 text-base font-medium text-gray-700 transition-colors duration-150 hover:bg-gray-100 active:bg-gray-200 dark:text-slate-200 dark:hover:bg-slate-700/50 dark:active:bg-slate-700 pl-4" data-close-menu="true"> About </a>  </div>  </div> </nav> </div> </div> <nav id="mobile-bottom-nav" class="fixed bottom-0 z-50 w-full border-t border-gray-200/70 bg-white/95 backdrop-blur-md md:hidden dark:border-slate-700/40 dark:bg-slate-900/95 h-16"> <div class="mx-auto grid h-full grid-cols-4 items-center px-4"> <a href="https://deployn.de/en/" class="hover:text-primary-600 dark:hover:text-primary-300 flex flex-col items-center justify-center text-gray-700 transition-colors duration-200 active:scale-95 dark:text-gray-300" aria-label="Home"> <svg width="1em" height="1em" class="h-6 w-6" data-icon="tabler:home">   <symbol id="ai:tabler:home" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M5 12H3l9-9l9 9h-2M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-7"/><path d="M9 21v-6a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v6"/></g></symbol><use href="#ai:tabler:home"></use>  </svg> <span class="mt-1 text-[10px] font-medium">Home</span> </a> <div class="flex flex-col items-center justify-center"> <div x-data="{
				theme: localStorage.theme || 'system',
				updateDocumentClassTheme: function() {
					if (localStorage.theme === 'dark' || (!('theme' in localStorage) &#38;&#38; window.matchMedia('(prefers-color-scheme: dark)').matches)) {
						document.documentElement.classList.add('dark');
					} else {
						document.documentElement.classList.remove('dark');
					}
				},
				switchTheme: function (newValue) {
					if (newValue == 'dark') {
						localStorage.theme = 'dark';
					} else if (newValue == 'light') {
						localStorage.theme = 'light';
					} else {
						localStorage.removeItem('theme');
					}
					this.updateDocumentClassTheme();
				},
				toggleTheme: function () {
					if (this.theme === 'light') {
						this.theme = 'dark';
					} else if (this.theme === 'dark') {
						this.theme = 'light';
					} else {
						this.theme = 'dark';
					}
					this.switchTheme(this.theme);
				}
			}" aria-label="Toggle Dark/Light Mode" id="theme-selector" class="flex items-center justify-center" x-init="updateDocumentClassTheme()" x-model="theme" @change="switchTheme($event.target.value)" data-astro-cid-lgn464si> <div class="hidden items-center justify-center p-4 md:flex" data-astro-cid-lgn464si> <button :class="{'bg-gray-200': theme === 'light', 'bg-slate-700': theme === 'dark'}" class="theme-toggle-button hover:ring-primary-400/50 relative inline-flex h-10 w-20 items-center justify-center rounded-full shadow-sm transition-colors hover:ring-2 focus:outline-none" @click="toggleTheme()" :aria-checked="theme === 'dark'" role="switch" data-astro-cid-lgn464si> <span :class="{'translate-x-5': theme === 'dark', '-translate-x-5': theme === 'light'}" class="theme-toggle-thumb inline-flex h-8 w-8 transform items-center justify-center rounded-full bg-white shadow-md transition-transform dark:bg-slate-800" data-astro-cid-lgn464si> <span class="theme-icon-light" x-show="theme === 'light'" data-astro-cid-lgn464si>ðŸŒž</span> <span class="theme-icon-dark" x-show="theme === 'dark'" data-astro-cid-lgn464si>ðŸŒœ</span> <span class="theme-icon-system" x-show="theme === 'system'" data-astro-cid-lgn464si>ðŸŒ“</span> </span> </button> </div> <button @click="toggleTheme()" class="flex h-6 w-6 items-center justify-center md:hidden" aria-label="Toggle theme" data-astro-cid-lgn464si> <span x-show="theme === 'light'" class="block" data-astro-cid-lgn464si>ðŸŒž</span> <span x-show="theme === 'dark'" class="block" data-astro-cid-lgn464si>ðŸŒœ</span> <span x-show="theme === 'system'" class="block" data-astro-cid-lgn464si>ðŸŒ“</span> </button> </div>  <span class="mt-0 text-[10px] font-medium text-gray-700 dark:text-gray-300">Theme</span> </div> <div class="flex flex-col items-center justify-center">  <!-- Desktop Version --><select aria-label="Change language" class="hidden cursor-pointer rounded-md px-4 py-2 text-lg shadow-md focus-visible:outline-none dark:bg-stone-800 dark:text-stone-50 md:block" x-data="dropdownData" @change="changePage($event)"> <option value="/de/blog/setup-vaultwarden/"> DE </option><option value="/en/blog/setup-vaultwarden/" selected> EN </option> </select> <!-- Mobile Version --> <button x-data="dropdownData" @click="toggleLanguage" class="block h-6 w-6 items-center justify-center text-base font-medium md:hidden" aria-label="Toggle language"> <span x-text="currentLocale.toUpperCase()"></span> </button> <span class="-mt-0.5 text-[10px] font-medium text-gray-700 dark:text-gray-300">Lang</span> </div> <button id="mobile-menu-toggle" class="hover:text-primary-600 dark:hover:text-primary-300 flex flex-col items-center justify-center text-gray-700 transition-colors duration-200 active:scale-95 dark:text-gray-300" aria-label="Menu" aria-expanded="false" aria-controls="mobile-menu-panel"> <div class="relative h-6 w-6"> <svg width="1em" height="1em" class="toggle-icon-open absolute inset-0 h-6 w-6 opacity-100 transition-opacity duration-300" data-icon="tabler:menu-2">   <symbol id="ai:tabler:menu-2" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"/></symbol><use href="#ai:tabler:menu-2"></use>  </svg> <svg width="1em" height="1em" class="toggle-icon-close absolute inset-0 h-6 w-6 opacity-0 transition-opacity duration-300" data-icon="tabler:x">   <symbol id="ai:tabler:x" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18 6L6 18M6 6l12 12"/></symbol><use href="#ai:tabler:x"></use>  </svg> </div> <span class="mt-1 text-[10px] font-medium">Menu</span> </button> </div> </nav> </div> <script type="module">function b(){const e=document.createElement("div");e.style.visibility="hidden",e.style.overflow="scroll",e.style.msOverflowStyle="scrollbar",document.body.appendChild(e);const n=document.createElement("div");e.appendChild(n);const a=e.offsetWidth-n.offsetWidth;return e.parentNode?.removeChild(e),a}function y(){const e=document.getElementById("mobile-menu-toggle"),n=document.getElementById("mobile-menu-panel"),a=document.getElementById("mobile-backdrop"),u=document.documentElement,m=document.body;let l=!1,g=0;n&&(n.classList.add("translate-y-full"),n.setAttribute("aria-hidden","true")),a&&a.classList.add("hidden","opacity-0"),e&&(e.setAttribute("aria-expanded","false"),e.querySelector(".toggle-icon-open")?.classList.replace("opacity-0","opacity-100"),e.querySelector(".toggle-icon-close")?.classList.replace("opacity-100","opacity-0")),u.classList.remove("overflow-hidden-nav"),m.style.paddingRight="",n?.querySelectorAll(".submenu-panel").forEach(t=>{t.style.maxHeight="0",t.style.marginTop="0"}),n?.querySelectorAll(".submenu-toggle-button").forEach(t=>{t.setAttribute("aria-expanded","false"),t.querySelector("svg")?.classList.remove("rotate-90")});function f(){if(!n||!a||!e||l)return;l=!0,g=b(),m.style.paddingRight=`${g}px`,u.classList.add("overflow-hidden-nav"),n.classList.remove("translate-y-full"),n.setAttribute("aria-hidden","false"),a.classList.remove("hidden"),requestAnimationFrame(()=>{a?.classList.remove("opacity-0")}),e.setAttribute("aria-expanded","true"),e.querySelector(".toggle-icon-open")?.classList.replace("opacity-100","opacity-0"),e.querySelector(".toggle-icon-close")?.classList.replace("opacity-0","opacity-100"),n.querySelector("a[href], button:not([disabled])")?.focus()}function o(){!n||!a||!e||!l||(l=!1,n.classList.add("translate-y-full"),n.setAttribute("aria-hidden","true"),a&&(a.classList.add("opacity-0"),a.addEventListener("transitionend",()=>{l||a.classList.add("hidden")},{once:!0})),u.classList.remove("overflow-hidden-nav"),m.style.paddingRight="",e&&(e.setAttribute("aria-expanded","false"),e.querySelector(".toggle-icon-open")?.classList.replace("opacity-0","opacity-100"),e.querySelector(".toggle-icon-close")?.classList.replace("opacity-100","opacity-0")))}function h(t){const i=t.getAttribute("data-toggle-submenu");if(!i)return;const s=document.getElementById(i);if(!s)return;t.getAttribute("aria-expanded")==="true"?(t.setAttribute("aria-expanded","false"),t.querySelector("svg")?.classList.remove("rotate-90"),s.style.maxHeight="0",s.style.marginTop="0"):(t.setAttribute("aria-expanded","true"),t.querySelector("svg")?.classList.add("rotate-90"),s.style.marginTop="0.25rem",s.style.maxHeight=s.scrollHeight+"px")}const r=document.getElementById("mobile-menu-toggle"),c=document.getElementById("mobile-backdrop"),d=document.getElementById("mobile-menu-panel");if(r&&!r._navListenerAttached&&(r._navListenerAttached=!0,r.addEventListener("click",()=>{l?o():f()})),c&&!c._navListenerAttached&&(c._navListenerAttached=!0,c.addEventListener("click",o)),d&&!d._navListenerAttached&&(d._navListenerAttached=!0,d.addEventListener("click",t=>{const i=t.target;i.closest('a[data-close-menu="true"]')&&o();const s=i.closest("button[data-toggle-submenu]");s&&h(s)})),!window._navbarEscapeHandlerAttached){const t=i=>{const s=document.getElementById("mobile-menu-panel"),p=s&&!s.classList.contains("translate-y-full");i.key==="Escape"&&p&&o()};document.addEventListener("keydown",t),window._navbarEscapeHandlerAttached=!0}}y();document.addEventListener("astro:page-load",y);</script> <main id="main-content" class="container mx-auto max-w-7xl flex-1 px-4 pt-16 pb-12 md:pt-20 md:pb-16" tabindex="-1">  <article class="w-full" data-pagefind-body>  <header class="border-border mb-12 border-b pb-10"> <div class="mx-auto max-w-4xl px-4 sm:px-6 lg:px-8">  <div class="mb-3 flex flex-wrap gap-2"> <a href="https://deployn.de/en/blog/category/homeserver/" class="main-text-gradient font-medium "> HOMESERVER </a> </div>  <h1 class="h1 text-foreground mb-4 text-3xl leading-tight font-bold md:text-4xl lg:text-5xl" data-astro-transition-scope="astro-kz7txu5a-2"> Self-hosting Vaultwarden: Step-by-Step Guide with Docker, Caddy, and Fail2Ban </h1>  <p class="text-foreground/70 text-lg md:text-xl"> Host your own password manager, Vaultwarden, securely and efficiently. Install Vaultwarden as a Docker container and secure it with Fail2Ban. </p>    <div class="text-foreground/60 mt-4 flex flex-wrap items-center gap-x-4 gap-y-2 text-sm"> <div class="flex items-center"> <svg width="1em" height="1em" class="mr-1.5 h-4 w-4 flex-shrink-0" data-icon="tabler:calendar-event">   <symbol id="ai:tabler:calendar-event" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M4 7a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v12a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2zm12-4v4M8 3v4m-4 4h16"/><path d="M8 15h2v2H8z"/></g></symbol><use href="#ai:tabler:calendar-event"></use>  </svg> <time datetime="2025-04-30T00:00:00.000Z"> <time datetime="2025-04-30T00:00:00.000Z"> Apr 30, 2025 </time> </time> </div>  </div>  </div> </header>  <div class="mx-auto mb-12 max-w-5xl px-4 sm:px-6 lg:px-8"> <img src="https://deployn.de/_astro/image.DfNhu_Dn_2wbNNI.avif" srcset="/_astro/image.DfNhu_Dn_2vvy0p.avif 400w, /_astro/image.DfNhu_Dn_3weWS.avif 800w, /_astro/image.DfNhu_Dn_2wbNNI.avif 1200w" alt="Self-hosting Vaultwarden: Step-by-Step Guide with Docker, Caddy, and Fail2Ban hero image" sizes="(max-width: 767px) 100vw, (max-width: 1023px) 80vw, 1200px" loading="eager" decoding="sync" data-astro-transition-scope="astro-zjltrpfb-3" width="1200" height="675" class="aspect-video w-full rounded-xl object-cover shadow-lg"> </div>  <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8"> <div class="gap-8 xl:grid xl:grid-cols-4">  <aside class="sticky top-24 col-span-1 hidden h-fit py-8 xl:block"> <div class="space-y-4"> <span class="text-muted-foreground block text-sm font-medium tracking-wide uppercase"> Share </span> <div class="flex gap-2 lg:flex-col" data-astro-cid-xiyysuza> <a class="share-button bg-[#000] hover:bg-[#000]/80 flex-col space-y-3 items-start" href="https://twitter.com/intent/tweet?url=https://deployn.de/en/blog/setup-vaultwarden/&amp;text=Check%20out%20this%20great%20post!" target="_blank" rel="noopener noreferrer" aria-label="Share on X (Twitter)" data-astro-cid-xiyysuza> <svg width="1em" height="1em" class="w-6 h-6 text-inherit" aria-hidden="true" data-astro-cid-xiyysuza="true" data-icon="tabler:brand-x">   <symbol id="ai:tabler:brand-x" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m4 4l11.733 16H20L8.267 4zm0 16l6.768-6.768m2.46-2.46L20 4"/></symbol><use href="#ai:tabler:brand-x"></use>  </svg> </a> <a class="share-button bg-[#FF5700] hover:bg-[#FF5700]/80 flex-col space-y-3 items-start" href="https://www.reddit.com/submit?url=https://deployn.de/en/blog/setup-vaultwarden/&amp;title=Self-hosting%20Vaultwarden%3A%20Step-by-Step%20Guide%20with%20Docker%2C%20Caddy%2C%20and%20Fail2Ban" target="_blank" rel="noopener noreferrer" aria-label="Share on Reddit" data-astro-cid-xiyysuza> <svg width="1em" height="1em" class="w-6 h-6 text-inherit" aria-hidden="true" data-astro-cid-xiyysuza="true" data-icon="logos:reddit-icon">   <symbol id="ai:logos:reddit-icon" viewBox="0 0 256 256"><circle cx="128" cy="128" r="128" fill="#FF4500"/><path fill="#FFF" d="M213.15 129.22c0-10.376-8.391-18.617-18.617-18.617a18.74 18.74 0 0 0-12.97 5.189c-12.818-9.157-30.368-15.107-49.9-15.87l8.544-39.981l27.773 5.95c.307 7.02 6.104 12.667 13.278 12.667c7.324 0 13.275-5.95 13.275-13.278c0-7.324-5.95-13.275-13.275-13.275c-5.188 0-9.768 3.052-11.904 7.478l-30.976-6.562c-.916-.154-1.832 0-2.443.458c-.763.458-1.22 1.22-1.371 2.136l-9.464 44.558c-19.837.612-37.692 6.562-50.662 15.872a18.74 18.74 0 0 0-12.971-5.188c-10.377 0-18.617 8.391-18.617 18.617c0 7.629 4.577 14.037 10.988 16.939a33.6 33.6 0 0 0-.458 5.646c0 28.686 33.42 52.036 74.621 52.036c41.202 0 74.622-23.196 74.622-52.036a35 35 0 0 0-.458-5.646c6.408-2.902 10.985-9.464 10.985-17.093M85.272 142.495c0-7.324 5.95-13.275 13.278-13.275c7.324 0 13.275 5.95 13.275 13.275s-5.95 13.278-13.275 13.278c-7.327.15-13.278-5.953-13.278-13.278m74.317 35.251c-9.156 9.157-26.553 9.768-31.588 9.768c-5.188 0-22.584-.765-31.59-9.768c-1.371-1.373-1.371-3.51 0-4.883c1.374-1.371 3.51-1.371 4.884 0c5.8 5.8 18.008 7.782 26.706 7.782s21.058-1.983 26.704-7.782c1.374-1.371 3.51-1.371 4.884 0c1.22 1.373 1.22 3.51 0 4.883m-2.443-21.822c-7.325 0-13.275-5.95-13.275-13.275s5.95-13.275 13.275-13.275c7.327 0 13.277 5.95 13.277 13.275c0 7.17-5.95 13.275-13.277 13.275"/></symbol><use href="#ai:logos:reddit-icon"></use>  </svg> </a> <a class="share-button bg-[hsl(220,1%,43%)] hover:bg-[hsl(220,1%,33%)] flex-col space-y-3 items-start" href="mailto:?subject=Self-hosting%20Vaultwarden%3A%20Step-by-Step%20Guide%20with%20Docker%2C%20Caddy%2C%20and%20Fail2Ban&#38;body=https://deployn.de/en/blog/setup-vaultwarden/" target="_blank" rel="noopener noreferrer" aria-label="Share through email" data-astro-cid-xiyysuza> <svg width="1em" height="1em" class="w-6 h-6 text-inherit" aria-hidden="true" data-astro-cid-xiyysuza="true" data-icon="tabler:mail">   <symbol id="ai:tabler:mail" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M3 7a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><path d="m3 7l9 6l9-6"/></g></symbol><use href="#ai:tabler:mail"></use>  </svg> </a> <button onclick="copyLinkToClipboard(this)" class="share-button copy-link-button bg-gray-600 hover:bg-gray-700 flex-col space-y-3 items-start" aria-label="Copy link to post" data-astro-cid-xiyysuza> <svg width="1em" height="1em" class="w-6 h-6 text-inherit" aria-hidden="true" data-astro-cid-xiyysuza="true" data-icon="tabler:link">   <symbol id="ai:tabler:link" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m9 15l6-6m-4-3l.463-.536a5 5 0 0 1 7.071 7.072L18 13m-5 5l-.397.534a5.07 5.07 0 0 1-7.127 0a4.97 4.97 0 0 1 0-7.071L6 11"/></symbol><use href="#ai:tabler:link"></use>  </svg> </button> </div> <script>
	function copyLinkToClipboard(button) {
		navigator.clipboard
			.writeText(window.location.href)
			.then(() => {
				const icon = button.querySelector("svg");
				if (icon) {
					icon.setAttribute("name", "tabler:check");
					setTimeout(() => {
						icon.setAttribute("name", "tabler:link");
					}, 2000);
				}
			})
			.catch((err) => {
				console.error("Failed to copy: ", err);
			});
	}
</script>  </div> </aside>  <div class="col-span-4 py-8 xl:col-span-2">  <div class="bg-muted/50 border-border mb-8 rounded-lg border p-6 xl:hidden"> <h2 class="text-foreground mb-4 text-lg font-semibold">Table of Contents</h2> <div class="border-accent mt-1 border-l-4 py-2 pl-4 text-sm leading-tight lg:text-base"> <ul class="flex flex-col gap-2"> <li class="pl-3"> <a href="#what-is-vaultwarden" class="transition hover:text-primary-600 dark:hover:text-primary-400"> What is Vaultwarden? </a> </li><li class="pl-3"> <a href="#prerequisites" class="transition hover:text-primary-600 dark:hover:text-primary-400"> Prerequisites </a> </li><li class="pl-3"> <a href="#step-1-server-preparation" class="transition hover:text-primary-600 dark:hover:text-primary-400"> Step 1: Server Preparation </a> </li><li class="pl-3"> <a href="#step-2-create-docker-network" class="transition hover:text-primary-600 dark:hover:text-primary-400"> Step 2: Create Docker Network </a> </li><li class="pl-3"> <a href="#step-3-create-vaultwarden-directory-structure" class="transition hover:text-primary-600 dark:hover:text-primary-400"> Step 3: Create Vaultwarden Directory Structure </a> </li><li class="pl-3"> <a href="#step-4-create-docker-compose-file-for-vaultwarden" class="transition hover:text-primary-600 dark:hover:text-primary-400"> Step 4: Create Docker Compose File for Vaultwarden </a> </li><li class="pl-3"> <a href="#step-5-start-vaultwarden" class="transition hover:text-primary-600 dark:hover:text-primary-400"> Step 5: Start Vaultwarden </a> </li><li class="pl-3"> <a href="#step-6-configure-reverse-proxy-caddy" class="transition hover:text-primary-600 dark:hover:text-primary-400"> Step 6: Configure Reverse Proxy (Caddy) </a> </li><li class="pl-3"> <a href="#step-7-first-access-and-account-creation" class="transition hover:text-primary-600 dark:hover:text-primary-400"> Step 7: First Access and Account Creation </a> </li><li class="pl-3"> <a href="#step-8-secure-admin-area-and-disable-registration" class="transition hover:text-primary-600 dark:hover:text-primary-400"> Step 8: Secure Admin Area and Disable Registration </a> </li><li class="pl-3"> <a href="#step-9-configure-logging-for-vaultwarden" class="transition hover:text-primary-600 dark:hover:text-primary-400"> Step 9: Configure Logging for Vaultwarden </a> </li><li class="pl-3"> <a href="#step-10-set-up-fail2ban-for-additional-security" class="transition hover:text-primary-600 dark:hover:text-primary-400"> Step 10: Set Up Fail2Ban for Additional Security </a> </li><li class="pl-3"> <a href="#step-11-create-fail2ban-configuration" class="transition hover:text-primary-600 dark:hover:text-primary-400"> Step 11: Create Fail2Ban Configuration </a> </li><li class="pl-3"> <a href="#step-12-start-and-test-fail2ban" class="transition hover:text-primary-600 dark:hover:text-primary-400"> Step 12: Start and Test Fail2Ban </a> </li><li class="pl-3"> <a href="#step-13-backup-strategy" class="transition hover:text-primary-600 dark:hover:text-primary-400"> Step 13: Backup Strategy </a> </li><li class="pl-3"> <a href="#summary" class="transition hover:text-primary-600 dark:hover:text-primary-400"> Summary </a> </li> </ul> </div> </div> <section id="blog-post-content" class="prose prose-lg mx-auto max-w-prose">  <h2 id="what-is-vaultwarden">What is Vaultwarden?</h2>
<p>Vaultwarden is an alternative server for the Bitwarden ecosystem, written in the Rust programming language. This makes it particularly performant and resource-friendly â€“ ideal for a home server or a small VPS. You can use all official Bitwarden clients (browser extensions, desktop apps, mobile apps) with it.</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>Before we start, make sure you have the following:</p>
<ol>
<li><strong>A Server:</strong> A server with a common Linux operating system. Iâ€™m using Ubuntu 24.04 here, but other distributions work similarly.</li>
<li><strong>Docker and Docker Compose:</strong> Must be installed on the server.</li>
<li><strong>A Domain:</strong> A domain or subdomain that points to the public IP address of your server.</li>
<li><strong>A Reverse Proxy:</strong> A working reverse proxy. In this tutorial, weâ€™ll use Caddy. Other proxies like Nginx Proxy Manager or Traefik are also possible but require adjusted configuration.</li>
<li><strong>(Optional) Pengolin:</strong> If youâ€™re using a home server without a fixed public IPv4 address, check out <a href="https://deployn.de/blog/setup-pangolin/">Pengolin</a> (or a similar tool/guide) to make your server accessible.</li>
</ol>
<h2 id="step-1-server-preparation">Step 1: Server Preparation</h2>
<p>Open a terminal and connect to your server via SSH.</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">ssh</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> your_user@YOUR_SERVER_IP</span></span></code></pre>
<p>Replace <code>your_user</code> and <code>YOUR_SERVER_IP</code> accordingly.</p>
<p><strong>Domain Check:</strong> Ensure that your domain correctly points to your serverâ€™s IP.</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">ping</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> password.yourdomain.com</span></span></code></pre>
<p>Replace <code>password.yourdomain.com</code> with your desired domain. The output should show your serverâ€™s IP address. If not, check your DNS settings and wait for propagation if necessary.</p>
<p><strong>Docker Check:</strong> Check if Docker and Docker Compose are installed.</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">docker</span><span style="color:#005CC5;--shiki-dark:#BD93F9"> -v</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">docker</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> compose</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> version</span></span></code></pre>
<p>You should see the version numbers. If not, install Docker and Docker Compose according to the official documentation for your operating system.</p>
<h2 id="step-2-create-docker-network">Step 2: Create Docker Network</h2>
<p>We need a shared Docker network so that our reverse proxy (Caddy) can communicate with the Vaultwarden container.</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">sudo</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> docker</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> network</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> create</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> proxy</span></span></code></pre>
<p>Weâ€™ll call the network <code>proxy</code>. You can verify the name with:</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">sudo</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> docker</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> network</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> ls</span></span></code></pre>
<h2 id="step-3-create-vaultwarden-directory-structure">Step 3: Create Vaultwarden Directory Structure</h2>
<p>Create a directory for the Vaultwarden configuration and persistent data.</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">mkdir</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> ~/vaultwarden</span></span>
<span class="line"><span style="color:#005CC5;--shiki-dark:#8BE9FD">cd</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> ~/vaultwarden</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">mkdir</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> vw-data</span></span></code></pre>
<p>The <code>vw-data</code> folder will later contain the encrypted database, attachments, and settings of Vaultwarden.</p>
<h2 id="step-4-create-docker-compose-file-for-vaultwarden">Step 4: Create Docker Compose File for Vaultwarden</h2>
<p>Create a <code>docker-compose.yml</code> file in the <code>~/vaultwarden</code> directory:</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">nano</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> docker-compose.yml</span></span></code></pre>
<p>Paste the following content and adapt it:</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="yaml"><code><span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">version</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span><span style="color:#032F62;--shiki-dark:#E9F284"> &quot;</span><span style="color:#032F62;--shiki-dark:#F1FA8C">3</span><span style="color:#032F62;--shiki-dark:#E9F284">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">services</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">    vaultwarden</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">        image</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> vaultwarden/server:1.31.0</span><span style="color:#6A737D;--shiki-dark:#6272A4"> # Use a specific tag instead of &#39;latest&#39; (Note: Original German text mentioned 1.33.2 in the adjustment notes, but used 1.31.0 here. Sticking to 1.31.0 as per the code block.)</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">        container_name</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> vaultwarden</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">        restart</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> always</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">        environment</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4">            # - WEBSOCKET_ENABLED=true # Disable WebSocket if not needed or if causing issues</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4">            # Admin token will be added here later</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4">            # ADMIN_TOKEN: &#39;YOUR_SECURE_ADMIN_TOKEN_HASH&#39;</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4">            # Set timezone (Important for logs and Fail2Ban)</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">            TZ</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span><span style="color:#032F62;--shiki-dark:#E9F284"> &quot;</span><span style="color:#032F62;--shiki-dark:#F1FA8C">Europe/Berlin</span><span style="color:#032F62;--shiki-dark:#E9F284">&quot;</span><span style="color:#6A737D;--shiki-dark:#6272A4"> # Adjust this to your time zone</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">        volumes</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#FF79C6">            -</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> ./vw-data:/data</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4">            # Mounts for time zone (Important for correct log times -&gt; Fail2Ban)</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#FF79C6">            -</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> /etc/localtime:/etc/localtime:ro</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#FF79C6">            -</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> /etc/timezone:/etc/timezone:ro</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4">        # Network for connecting to the reverse proxy</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">        networks</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#FF79C6">            -</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> proxy</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4">        # Run as non-root user (optional but recommended)</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4">        # Find your User/Group ID with &#39;id&#39; in the terminal</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4">        # user: &#39;1000:1000&#39; # Replace 1000:1000 with your UID:GID</span></span>
<span class="line"></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">networks</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">    proxy</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">        external</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span><span style="color:#005CC5;--shiki-dark:#BD93F9"> true</span><span style="color:#6A737D;--shiki-dark:#6272A4"> # We use the previously created external network</span></span></code></pre>
<p><strong>Important Adjustments:</strong></p>
<ol>
<li><strong>Image Tag:</strong> I used <code>vaultwarden/server:1.31.0</code>. Check on <a href="https://github.com/dani-garcia/vaultwarden/releases">GitHub</a> for the latest stable version and replace the tag accordingly. Using a specific tag prevents unexpected updates and facilitates manual, controlled updates. (The German text mentioned updating to <code>1.33.2</code> in this description, but the code used <code>1.31.0</code>. Adjust the tag in the code if you prefer <code>1.33.2</code> or the latest.)</li>
<li><strong>Ports:</strong> We remove the <code>ports</code> section as access should only occur via the reverse proxy.</li>
<li><strong>Network:</strong> We add the container to the <code>proxy</code> network and declare it as <code>external</code>.</li>
<li><strong>User (Optional):</strong> To increase security, you can run the container under your normal user. Find your User ID (UID) and Group ID (GID) with the <code>id</code> command on your server and add the <code>user: &#39;UID:GID&#39;</code> line (uncomment it). Ensure your user has write permissions on the <code>./vw-data</code> directory (e.g., <code>sudo chown YOUR_UID:YOUR_GID vw-data</code>).</li>
<li><strong>Time zone (TZ, Volumes):</strong> The <code>TZ</code> variable and the <code>localtime</code>/<code>timezone</code> volumes are important so that the logs in the container have the correct time. This is crucial for Fail2Ban later. Adjust <code>&#39;Europe/Berlin&#39;</code> to your time zone.</li>
</ol>
<p>Save the file (Ctrl+X, then Y, then Enter in <code>nano</code>).</p>
<h2 id="step-5-start-vaultwarden">Step 5: Start Vaultwarden</h2>
<p>Start the Vaultwarden container in the background:</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">sudo</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> docker</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> compose</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> up</span><span style="color:#005CC5;--shiki-dark:#BD93F9"> -d</span></span></code></pre>
<p>Docker will now download the Vaultwarden image (if not already present) and start the container.</p>
<h2 id="step-6-configure-reverse-proxy-caddy">Step 6: Configure Reverse Proxy (Caddy)</h2>
<p>Now letâ€™s configure Caddy so Vaultwarden is accessible via your domain and automatically gets an SSL certificate. Edit your Caddyfile:</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="caddy"><code><span class="line"><span style="color:#24292E;--shiki-dark:#F8F8F2">password.yourdomain.</span><span style="color:#D73A49;--shiki-dark:#FF79C6">com</span><span style="color:#24292E;--shiki-dark:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4">    # Add header for real client IP (important for logs/Fail2Ban)</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#FF79C6">    reverse_proxy</span><span style="color:#24292E;--shiki-dark:#F8F8F2"> vaultwarden:80 {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#FF79C6">        header_up</span><span style="color:#24292E;--shiki-dark:#F8F8F2"> X-Real-IP {remote_host}</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4">    # Optional: Adjust Caddy log level</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#FF79C6">    log</span><span style="color:#24292E;--shiki-dark:#F8F8F2"> {</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#FF79C6">        level</span><span style="color:#24292E;--shiki-dark:#F8F8F2"> WARN</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#F8F8F2">    }</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#F8F8F2">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4"># Add other domains here if needed</span></span></code></pre>
<p><strong>Important Points:</strong></p>
<ol>
<li>Replace <code>password.yourdomain.com</code> with your domain.</li>
<li><code>vaultwarden:80</code> refers to the container name (<code>vaultwarden</code>) and the internal port Vaultwarden listens on (default is 80).</li>
<li><code>header_up X-Real-IP {remote_host}</code> is <strong>crucial</strong> so that Vaultwarden sees the clientâ€™s real IP address and not the Caddy containerâ€™s IP. This is important for logs and Fail2Ban.</li>
<li>Adjust the <code>log level</code> if necessary to reduce Caddyâ€™s log output.</li>
</ol>
<p>Reload the Caddy configuration. If Caddy is running as a Docker container (e.g., named <code>caddy</code>), it might be:</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">sudo</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> docker</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> exec</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> caddy</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> caddy</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> reload</span><span style="color:#005CC5;--shiki-dark:#BD93F9"> -c</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> /etc/caddy/Caddyfile</span></span></code></pre>
<p>(Adjust the path to the Caddyfile inside the container if needed).</p>
<h2 id="step-7-first-access-and-account-creation">Step 7: First Access and Account Creation</h2>
<p>Open your browser and navigate to <code>https://password.yourdomain.com</code>. You should see the Vaultwarden web interface. Click on â€œCreate Accountâ€, enter your details, and create your first user account.</p>
<p>You can now log in and use the password manager!</p>
<h2 id="step-8-secure-admin-area-and-disable-registration">Step 8: Secure Admin Area and Disable Registration</h2>
<p>By default, anyone can create an account on your Vaultwarden instance. We want to change that. For this, we need access to the admin area, which is accessible via <code>https://password.yourdomain.com/admin</code>. This is protected by an admin token, which we first need to generate.</p>
<p><strong>Generate Admin Token:</strong></p>
<p>We use <code>argon2</code> to hash the admin password. Install it first (example for Debian/Ubuntu):</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">sudo</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> apt</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> update</span><span style="color:#24292E;--shiki-dark:#F8F8F2"> &amp;&amp; </span><span style="color:#6F42C1;--shiki-dark:#50FA7B">sudo</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> apt</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> install</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> argon2</span><span style="color:#005CC5;--shiki-dark:#BD93F9"> -y</span></span></code></pre>
<p>Now generate the hash for your desired admin password (replace <code>YourSecureAdminPassword</code>):</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#005CC5;--shiki-dark:#8BE9FD">echo</span><span style="color:#005CC5;--shiki-dark:#BD93F9"> -n</span><span style="color:#032F62;--shiki-dark:#E9F284"> &#39;</span><span style="color:#032F62;--shiki-dark:#F1FA8C">YourSecureAdminPassword</span><span style="color:#032F62;--shiki-dark:#E9F284">&#39;</span><span style="color:#D73A49;--shiki-dark:#FF79C6"> |</span><span style="color:#6F42C1;--shiki-dark:#50FA7B"> argon2</span><span style="color:#032F62;--shiki-dark:#E9F284"> &quot;</span><span style="color:#032F62;--shiki-dark:#F1FA8C">$(</span><span style="color:#6F42C1;--shiki-dark:#50FA7B">openssl</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> rand </span><span style="color:#005CC5;--shiki-dark:#BD93F9">-base64</span><span style="color:#005CC5;--shiki-dark:#BD93F9"> 16</span><span style="color:#032F62;--shiki-dark:#F1FA8C">)</span><span style="color:#032F62;--shiki-dark:#E9F284">&quot;</span><span style="color:#005CC5;--shiki-dark:#BD93F9"> -e</span><span style="color:#005CC5;--shiki-dark:#BD93F9"> -id</span><span style="color:#005CC5;--shiki-dark:#BD93F9"> -k</span><span style="color:#005CC5;--shiki-dark:#BD93F9"> 65536</span><span style="color:#005CC5;--shiki-dark:#BD93F9"> -t</span><span style="color:#005CC5;--shiki-dark:#BD93F9"> 3</span><span style="color:#005CC5;--shiki-dark:#BD93F9"> -p</span><span style="color:#005CC5;--shiki-dark:#BD93F9"> 4</span><span style="color:#D73A49;--shiki-dark:#FF79C6"> |</span><span style="color:#6F42C1;--shiki-dark:#50FA7B"> sed</span><span style="color:#032F62;--shiki-dark:#E9F284"> &#39;</span><span style="color:#032F62;--shiki-dark:#F1FA8C">s/\$/\$\$/g</span><span style="color:#032F62;--shiki-dark:#E9F284">&#39;</span></span></code></pre>
<p>Copy the <strong>entire output</strong>, starting with <code>$$argon2id$$...</code>.</p>
<p><strong>Add Admin Token to <code>docker-compose.yml</code>:</strong></p>
<p>Open the <code>docker-compose.yml</code> again:</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">nano</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> docker-compose.yml</span></span></code></pre>
<p>Add the <code>ADMIN_TOKEN</code> variable under <code>environment</code> or uncomment it and paste the hash:</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="yaml"><code><span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4"># ... (other services or settings)</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">services</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">    vaultwarden</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4">        # ... (other Vaultwarden settings)</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">        environment</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4">            # ... (other environment variables like TZ)</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">            ADMIN_TOKEN</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> YOUR_COPIED_ARGON2_HASH</span><span style="color:#6A737D;--shiki-dark:#6272A4"> # Paste the copied hash here</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4">        # ... (rest of Vaultwarden configuration)</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4"># ... (networks etc.)</span></span></code></pre>
<p>Save the file and restart Vaultwarden for the change to take effect:</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">sudo</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> docker</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> compose</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> down</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">sudo</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> docker</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> compose</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> up</span><span style="color:#005CC5;--shiki-dark:#BD93F9"> -d</span></span></code></pre>
<p><strong>Disable Registration:</strong></p>
<ol>
<li>Go to <code>https://password.yourdomain.com/admin</code>.</li>
<li>Enter your <strong>original admin password</strong> (the one you put into the <code>echo</code> command above, <em>not</em> the hash).</li>
<li>Go to the â€œGeneral Settingsâ€.</li>
<li>Uncheck â€œAllow new signupsâ€.</li>
<li>Click â€œSaveâ€.</li>
</ol>
<p>Now try (e.g., in a private browser window) to create a new account. An error message should appear stating that registration is disabled.</p>
<p>In the admin panel, you can also configure SMTP settings for sending emails (useful for invitations or password resets) and manage users.</p>
<h2 id="step-9-configure-logging-for-vaultwarden">Step 9: Configure Logging for Vaultwarden</h2>
<p>To be able to log failed login attempts (which we need for Fail2Ban), we add logging options to the <code>docker-compose.yml</code>.</p>
<p>Open the <code>docker-compose.yml</code>:</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">nano</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> docker-compose.yml</span></span></code></pre>
<p>Add the following lines under <code>environment</code> in the <code>vaultwarden</code> service:</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="yaml"><code><span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4"># ...</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">services</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">    vaultwarden</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4">        # ...</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">        environment</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4">            # ... (TZ, ADMIN_TOKEN)</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">            LOG_FILE</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span><span style="color:#032F62;--shiki-dark:#E9F284"> &quot;</span><span style="color:#032F62;--shiki-dark:#F1FA8C">/data/vaultwarden.log</span><span style="color:#032F62;--shiki-dark:#E9F284">&quot;</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">            LOG_LEVEL</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span><span style="color:#032F62;--shiki-dark:#E9F284"> &quot;</span><span style="color:#032F62;--shiki-dark:#F1FA8C">warn</span><span style="color:#032F62;--shiki-dark:#E9F284">&quot;</span><span style="color:#6A737D;--shiki-dark:#6272A4"> # Logs warnings and errors (incl. failed logins)</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4">            # ...</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4">        # ...</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4"># ...</span></span></code></pre>
<p>Save the file and restart Vaultwarden:</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">sudo</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> docker</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> compose</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> down</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">sudo</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> docker</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> compose</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> up</span><span style="color:#005CC5;--shiki-dark:#BD93F9"> -d</span></span></code></pre>
<p>Now, failed logins will be written to the <code>vw-data/vaultwarden.log</code> file. You can test this by trying to log in with an incorrect password and then checking the log:</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">tail</span><span style="color:#005CC5;--shiki-dark:#BD93F9"> -f</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> ~/vaultwarden/vw-data/vaultwarden.log</span></span></code></pre>
<p>You should see a line like <code>[WARN] Wrong password provided for user...</code> or <code>[INFO] Login request failed...</code>, followed by the clientâ€™s IP address (thanks to <code>X-Real-IP</code> in the Caddy setup).</p>
<h2 id="step-10-set-up-fail2ban-for-additional-security">Step 10: Set Up Fail2Ban for Additional Security</h2>
<p>Fail2Ban monitors log files and bans IP addresses that make repeated failed login attempts. Weâ€™ll use the popular Fail2Ban Docker image from CrazyMax.</p>
<p><strong>Directory Structure for Fail2Ban:</strong></p>
<p>In the <code>~/vaultwarden</code> directory, create a folder for Fail2Ban data:</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#005CC5;--shiki-dark:#8BE9FD">cd</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> ~/vaultwarden</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">mkdir</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> fail2ban-data</span></span></code></pre>
<p><strong>Add Fail2Ban to <code>docker-compose.yml</code>:</strong></p>
<p>Open the <code>docker-compose.yml</code>:</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">nano</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> docker-compose.yml</span></span></code></pre>
<p>Add a new service for Fail2Ban:</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="yaml"><code><span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">services</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">    vaultwarden</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4">        # ... (Your Vaultwarden configuration from above) ...</span></span>
<span class="line"></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">    fail2ban</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">        image</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> crazymax/fail2ban:latest</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">        container_name</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> fail2ban</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">        restart</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> always</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4">        # Important: Host network mode allows Fail2Ban to modify host iptables</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">        network_mode</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> host</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4">        # Necessary capabilities for network administration</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">        cap_add</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#FF79C6">            -</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> NET_ADMIN</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#FF79C6">            -</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> NET_RAW</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">        environment</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4">            # Set the timezone matching your host and Vaultwarden</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">            TZ</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span><span style="color:#032F62;--shiki-dark:#E9F284"> &quot;</span><span style="color:#032F62;--shiki-dark:#F1FA8C">Europe/Berlin</span><span style="color:#032F62;--shiki-dark:#E9F284">&quot;</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4">            # Optional: Set the log level for Fail2Ban itself</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">            F2B_LOG_LEVEL</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span><span style="color:#032F62;--shiki-dark:#E9F284"> &quot;</span><span style="color:#032F62;--shiki-dark:#F1FA8C">INFO</span><span style="color:#032F62;--shiki-dark:#E9F284">&quot;</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">        volumes</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4">            # Persistent data for Fail2Ban (ban database, etc.)</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#FF79C6">            -</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> ./fail2ban-data:/data</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4">            # Vaultwarden log file (mount read-only)</span></span>
<span class="line"><span style="color:#24292E;--shiki-dark:#FF79C6">            -</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> ./vw-data/vaultwarden.log:/var/log/vaultwarden/vaultwarden.log:ro</span></span>
<span class="line"></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">networks</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">    proxy</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span></span>
<span class="line"><span style="color:#22863A;--shiki-dark:#8BE9FD">        external</span><span style="color:#24292E;--shiki-dark:#FF79C6">:</span><span style="color:#005CC5;--shiki-dark:#BD93F9"> true</span></span></code></pre>
<p><strong>Important Points:</strong></p>
<ol>
<li><code>network_mode: host</code>: Allows Fail2Ban to directly access the host systemâ€™s network configuration and <code>iptables</code> to block IPs.</li>
<li><code>cap_add: [NET_ADMIN, NET_RAW]</code>: Gives the container the necessary privileges for this.</li>
<li><code>volumes</code>: We mount the <code>fail2ban-data</code> directory for configuration and the database, as well as the <code>vaultwarden.log</code> (read-only!). The path <code>/var/log/vaultwarden/vaultwarden.log</code> inside the container is the path we will use later in the Fail2Ban configuration.</li>
<li><code>TZ</code>: Make sure the time zone here matches the hostâ€™s and the Vaultwarden containerâ€™s!</li>
</ol>
<p>Save the file.</p>
<h2 id="step-11-create-fail2ban-configuration">Step 11: Create Fail2Ban Configuration</h2>
<p>We need to tell Fail2Ban <em>what</em> to look for in the log file (Filter) and <em>what</em> to do when it finds something (Jail).</p>
<p>Change to the Fail2Ban data directory and create the necessary subfolders:</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#005CC5;--shiki-dark:#8BE9FD">cd</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> ~/vaultwarden/fail2ban-data</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">mkdir</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> filter.d</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> jail.d</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> action.d</span></span></code></pre>
<p><strong>Create Filters:</strong></p>
<p>Create a filter file for normal Vaultwarden logins:</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">nano</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> filter.d/vaultwarden.local</span></span></code></pre>
<p>Paste the following content:</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="ini"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#F8F8F2">[Includes]</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#FF79C6">before</span><span style="color:#24292E;--shiki-dark:#FF79C6"> =</span><span style="color:#24292E;--shiki-dark:#F8F8F2"> common.conf</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#F8F8F2">[Definition]</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#FF79C6">failregex</span><span style="color:#24292E;--shiki-dark:#FF79C6"> =</span><span style="color:#24292E;--shiki-dark:#F8F8F2"> ^.*?Username or password is incorrect\. Try again\. IP: &lt;ADDR&gt;\..*$</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#FF79C6">ignoreregex</span><span style="color:#24292E;--shiki-dark:#FF79C6"> =</span></span></code></pre>
<p><em>(Note: The exact <code>failregex</code> might need slight adjustments depending on your specific Vaultwarden log output format. Test with your logs.)</em></p>
<p>Save the file.</p>
<p>Create a filter file for failed admin logins:</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">nano</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> filter.d/vaultwarden-admin.local</span></span></code></pre>
<p>Paste the following content:</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="ini"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#F8F8F2">[Includes]</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#FF79C6">before</span><span style="color:#24292E;--shiki-dark:#FF79C6"> =</span><span style="color:#24292E;--shiki-dark:#F8F8F2"> common.conf</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#F8F8F2">[Definition]</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#FF79C6">failregex</span><span style="color:#24292E;--shiki-dark:#FF79C6"> =</span><span style="color:#24292E;--shiki-dark:#F8F8F2"> ^.*?Invalid admin token\. IP: &lt;ADDR&gt;.*$</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4"># ignoreregex =</span></span></code></pre>
<p><em>(Note: Check your admin log format for the exact message and adjust <code>failregex</code> if needed. Use <code>&lt;ADDR&gt;</code> to capture the IP.)</em></p>
<p>Save the file.</p>
<p><strong>Create Jail:</strong></p>
<p>Create a central jail configuration file:</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">nano</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> jail.d/vaultwarden.local</span></span></code></pre>
<p>Paste the following content and adjust the values as needed:</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="ini"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#F8F8F2">[vaultwarden]</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#FF79C6">enabled</span><span style="color:#24292E;--shiki-dark:#FF79C6">  =</span><span style="color:#24292E;--shiki-dark:#F8F8F2"> true</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4"># Path to the log file as mounted inside the Fail2Ban container</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#FF79C6">logpath</span><span style="color:#24292E;--shiki-dark:#FF79C6">  =</span><span style="color:#24292E;--shiki-dark:#F8F8F2"> /var/log/vaultwarden/vaultwarden.log</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4"># Filter used (name of the .local file without extension)</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#FF79C6">filter</span><span style="color:#24292E;--shiki-dark:#FF79C6">   =</span><span style="color:#24292E;--shiki-dark:#F8F8F2"> vaultwarden</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4"># Action using iptables, targeting the DOCKER-USER chain often used for host network mode containers</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#FF79C6">action</span><span style="color:#24292E;--shiki-dark:#FF79C6">   =</span><span style="color:#24292E;--shiki-dark:#F8F8F2"> iptables-allports[</span><span style="color:#D73A49;--shiki-dark:#FF79C6">name</span><span style="color:#24292E;--shiki-dark:#FF79C6">=</span><span style="color:#24292E;--shiki-dark:#F8F8F2">vaultwarden, </span><span style="color:#D73A49;--shiki-dark:#FF79C6">chain</span><span style="color:#24292E;--shiki-dark:#FF79C6">=</span><span style="color:#24292E;--shiki-dark:#F8F8F2">DOCKER-USER]</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4"># Specify ports usually exposed by the reverse proxy</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#FF79C6">ports</span><span style="color:#24292E;--shiki-dark:#FF79C6">    =</span><span style="color:#24292E;--shiki-dark:#F8F8F2"> http,https </span><span style="color:#6A737D;--shiki-dark:#6272A4"># Corresponds to 80, 443</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4"># Maximum number of failed attempts</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#FF79C6">maxretry</span><span style="color:#24292E;--shiki-dark:#FF79C6"> =</span><span style="color:#24292E;--shiki-dark:#F8F8F2"> 5</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4"># Time window for failed attempts (e.g., 1h = 1 hour)</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#FF79C6">findtime</span><span style="color:#24292E;--shiki-dark:#FF79C6"> =</span><span style="color:#24292E;--shiki-dark:#F8F8F2"> 1h</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4"># Ban duration (e.g., 24h = 24 hours, 1d = 1 day, 1w = 1 week)</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#FF79C6">bantime</span><span style="color:#24292E;--shiki-dark:#FF79C6">  =</span><span style="color:#24292E;--shiki-dark:#F8F8F2"> 24h</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#F8F8F2">[vaultwarden-admin]</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#FF79C6">enabled</span><span style="color:#24292E;--shiki-dark:#FF79C6">  =</span><span style="color:#24292E;--shiki-dark:#F8F8F2"> true</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#FF79C6">logpath</span><span style="color:#24292E;--shiki-dark:#FF79C6">  =</span><span style="color:#24292E;--shiki-dark:#F8F8F2"> /var/log/vaultwarden/vaultwarden.log</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#FF79C6">filter</span><span style="color:#24292E;--shiki-dark:#FF79C6">   =</span><span style="color:#24292E;--shiki-dark:#F8F8F2"> vaultwarden-admin</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#FF79C6">action</span><span style="color:#24292E;--shiki-dark:#FF79C6">   =</span><span style="color:#24292E;--shiki-dark:#F8F8F2"> iptables-allports[</span><span style="color:#D73A49;--shiki-dark:#FF79C6">name</span><span style="color:#24292E;--shiki-dark:#FF79C6">=</span><span style="color:#24292E;--shiki-dark:#F8F8F2">vaultwarden-admin, </span><span style="color:#D73A49;--shiki-dark:#FF79C6">chain</span><span style="color:#24292E;--shiki-dark:#FF79C6">=</span><span style="color:#24292E;--shiki-dark:#F8F8F2">DOCKER-USER]</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#FF79C6">ports</span><span style="color:#24292E;--shiki-dark:#FF79C6">    =</span><span style="color:#24292E;--shiki-dark:#F8F8F2"> http,https</span></span>
<span class="line"><span style="color:#6A737D;--shiki-dark:#6272A4"># Stricter rules for admin access</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#FF79C6">maxretry</span><span style="color:#24292E;--shiki-dark:#FF79C6"> =</span><span style="color:#24292E;--shiki-dark:#F8F8F2"> 3</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#FF79C6">findtime</span><span style="color:#24292E;--shiki-dark:#FF79C6"> =</span><span style="color:#24292E;--shiki-dark:#F8F8F2"> 10h</span></span>
<span class="line"><span style="color:#D73A49;--shiki-dark:#FF79C6">bantime</span><span style="color:#24292E;--shiki-dark:#FF79C6">  =</span><span style="color:#24292E;--shiki-dark:#F8F8F2"> 7d </span><span style="color:#6A737D;--shiki-dark:#6272A4"># 7 day ban</span></span></code></pre>
<p><strong>Important Parameters:</strong></p>
<ul>
<li><code>enabled = true</code>: Activates the jail.</li>
<li><code>logpath</code>: Must exactly match the path where the log file is accessible <em>inside the Fail2Ban container</em>.</li>
<li><code>filter</code>: The name of the corresponding filter file in <code>filter.d</code> (without <code>.local</code>).</li>
<li><code>action = iptables-allports[name=..., chain=DOCKER-USER]</code>: Uses <code>iptables</code> to block all ports for the offending IP, placing the rule in the <code>DOCKER-USER</code> chain. This chain is commonly used and processed before Dockerâ€™s own rules when using <code>network_mode: host</code>. Check your <code>iptables -L</code> if this doesnâ€™t work; you might need a different chain like <code>INPUT</code>.</li>
<li><code>ports = http,https</code>: Specifies the ports relevant for the ban action (usually the web ports).</li>
<li><code>maxretry</code>: Number of allowed failed attempts.</li>
<li><code>findtime</code>: Time window during which the <code>maxretry</code> attempts must occur to trigger a ban.</li>
<li><code>bantime</code>: Duration of the ban in seconds (suffixes like <code>m</code>, <code>h</code>, <code>d</code>, <code>w</code> are possible).</li>
</ul>
<p>Adjust <code>maxretry</code>, <code>findtime</code>, and <code>bantime</code> according to your security requirements. Save the file.</p>
<h2 id="step-12-start-and-test-fail2ban">Step 12: Start and Test Fail2Ban</h2>
<p>Go back to the main directory (<code>cd ~/vaultwarden</code>) and restart both containers so all changes (Compose file, Fail2Ban configs) are loaded:</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">sudo</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> docker</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> compose</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> down</span></span>
<span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">sudo</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> docker</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> compose</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> up</span><span style="color:#005CC5;--shiki-dark:#BD93F9"> -d</span></span></code></pre>
<p>Check the Fail2Ban logs:</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">sudo</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> docker</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> compose</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> logs</span><span style="color:#005CC5;--shiki-dark:#BD93F9"> -f</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> fail2ban</span></span></code></pre>
<p>You should see messages indicating that the jails <code>vaultwarden</code> and <code>vaultwarden-admin</code> were found and started, and eventually something like <code>Server ready</code>.</p>
<p><strong>Testing:</strong></p>
<ol>
<li>
<p>Open your Vaultwarden login page (<code>https://password.yourdomain.com</code>).</p>
</li>
<li>
<p>Intentionally enter the wrong password 5 times (or according to your <code>maxretry</code> value for <code>[vaultwarden]</code>).</p>
</li>
<li>
<p>On the next attempt (or possibly before), the page should no longer load (timeout or connection error).</p>
</li>
<li>
<p>Check the status of the jail in the Fail2Ban container (replace <code>YOUR_CURRENT_IP</code> with the IP you tested from):</p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">sudo</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> docker</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> compose</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> exec</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> fail2ban</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> fail2ban-client</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> status</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> vaultwarden</span></span></code></pre>
<p>You should see your IP listed under â€œCurrently bannedâ€.</p>
</li>
<li>
<p><strong>Unban (if you locked yourself out):</strong></p>
<pre class="astro-code astro-code-themes github-light dracula" style="background-color:#fff;--shiki-dark-bg:#282A36;color:#24292e;--shiki-dark:#F8F8F2;overflow-x:auto;white-space:pre-wrap;word-wrap:break-word" tabindex="0" data-language="bash"><code><span class="line"><span style="color:#6F42C1;--shiki-dark:#50FA7B">sudo</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> docker</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> compose</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> exec</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> fail2ban</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> fail2ban-client</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> set</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> vaultwarden</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> unbanip</span><span style="color:#032F62;--shiki-dark:#F1FA8C"> YOUR_CURRENT_IP</span></span></code></pre>
<p>After this, you should be able to load the page again.</p>
</li>
</ol>
<p>Repeat the test for the admin area (<code>/admin</code>) with an incorrect admin token if necessary to test the <code>vaultwarden-admin</code> jail (Note: <code>maxretry</code> is lower here).</p>
<h2 id="step-13-backup-strategy">Step 13: Backup Strategy</h2>
<p>A self-hosted service is only as good as its backup! Make sure you create backups regularly. Important data includes:</p>
<ol>
<li><strong>Vaultwarden Data:</strong> The entire content of the <code>~/vaultwarden/vw-data</code> folder. It contains the encrypted database, attachments, settings, and logs. <strong>This is the most critical part!</strong></li>
<li><strong>Fail2Ban Data:</strong> The entire content of the <code>~/vaultwarden/fail2ban-data</code> folder. It contains your configuration and the database of banned IPs.</li>
<li><strong>Docker Compose File:</strong> The <code>~/vaultwarden/docker-compose.yml</code>.</li>
<li><strong>Caddy Configuration:</strong> Your <code>Caddyfile</code> and potentially data generated by Caddy (certificates, etc., often under <code>/var/lib/caddy</code> or a mapped volume).</li>
</ol>
<p>There are many backup tools. <a href="https://deployn.de/blog/backups-duplicati/">Duplicati</a> is a common option. Ensure your backups are stored in a secure, external location and tested regularly!</p>
<h2 id="summary">Summary</h2>
<p>Congratulations! You have successfully:</p>
<ul>
<li>Set up Vaultwarden with Docker Compose.</li>
<li>Used a specific image tag and configured the container to run as a non-root user (optional).</li>
<li>Set up Caddy as a reverse proxy with SSL and the Real-IP header.</li>
<li>Secured the admin area with a token and disabled public registration.</li>
<li>Configured logging for Vaultwarden.</li>
<li>Set up and tested Fail2Ban for automatic blocking of attackers.</li>
<li>Recognized the importance of a backup strategy.</li>
</ul>
<p>Your own, secure password manager is now running on your server! You can now configure the Bitwarden browser extensions and apps with your server URL (<code>https://password.yourdomain.com</code>) and manage your passwords securely.</p>
<p>I hope this blog post helps you install Vaultwarden! Let me know if you have any adjustments or additions.</p>  </section>  <div class="border-border mt-8 border-t pt-6"> <div class="flex flex-wrap items-center gap-2"> <svg width="1em" height="1em" class="text-foreground/70 h-5 w-5 flex-shrink-0" data-icon="tabler:tag">   <symbol id="ai:tabler:tag" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path d="M6.5 7.5a1 1 0 1 0 2 0a1 1 0 1 0-2 0"/><path d="M3 6v5.172a2 2 0 0 0 .586 1.414l7.71 7.71a2.41 2.41 0 0 0 3.408 0l5.592-5.592a2.41 2.41 0 0 0 0-3.408l-7.71-7.71A2 2 0 0 0 11.172 3H6a3 3 0 0 0-3 3"/></g></symbol><use href="#ai:tabler:tag"></use>  </svg>  <a href="https://deployn.de/en/blog/tag/docker/" class="main-text-gradient font-medium ">
#docker </a><a href="https://deployn.de/en/blog/tag/password/" class="main-text-gradient font-medium ">
#password </a><a href="https://deployn.de/en/blog/tag/synology/" class="main-text-gradient font-medium ">
#synology </a><a href="https://deployn.de/en/blog/tag/tutorial/" class="main-text-gradient font-medium ">
#tutorial </a><a href="https://deployn.de/en/blog/tag/vaultwarden/" class="main-text-gradient font-medium ">
#vaultwarden </a> </div> </div>  <div class="border-border mt-8 border-t pt-6 xl:hidden"> <p class="text-muted-foreground mb-4 text-sm font-medium tracking-wide uppercase"> Share this post: </p> <div class="flex gap-2 lg:flex-col" data-astro-cid-xiyysuza> <a class="share-button bg-[#000] hover:bg-[#000]/80 flex flex-wrap gap-3 items-center justify-center" href="https://twitter.com/intent/tweet?url=https://deployn.de/en/blog/setup-vaultwarden/&amp;text=Check%20out%20this%20great%20post!" target="_blank" rel="noopener noreferrer" aria-label="Share on X (Twitter)" data-astro-cid-xiyysuza> <svg width="1em" height="1em" viewBox="0 0 24 24" class="w-6 h-6 text-inherit" aria-hidden="true" data-astro-cid-xiyysuza="true" data-icon="tabler:brand-x">   <use href="#ai:tabler:brand-x"></use>  </svg> </a> <a class="share-button bg-[#FF5700] hover:bg-[#FF5700]/80 flex flex-wrap gap-3 items-center justify-center" href="https://www.reddit.com/submit?url=https://deployn.de/en/blog/setup-vaultwarden/&amp;title=Self-hosting%20Vaultwarden%3A%20Step-by-Step%20Guide%20with%20Docker%2C%20Caddy%2C%20and%20Fail2Ban" target="_blank" rel="noopener noreferrer" aria-label="Share on Reddit" data-astro-cid-xiyysuza> <svg width="1em" height="1em" viewBox="0 0 256 256" class="w-6 h-6 text-inherit" aria-hidden="true" data-astro-cid-xiyysuza="true" data-icon="logos:reddit-icon">   <use href="#ai:logos:reddit-icon"></use>  </svg> </a> <a class="share-button bg-[hsl(220,1%,43%)] hover:bg-[hsl(220,1%,33%)] flex flex-wrap gap-3 items-center justify-center" href="mailto:?subject=Self-hosting%20Vaultwarden%3A%20Step-by-Step%20Guide%20with%20Docker%2C%20Caddy%2C%20and%20Fail2Ban&#38;body=https://deployn.de/en/blog/setup-vaultwarden/" target="_blank" rel="noopener noreferrer" aria-label="Share through email" data-astro-cid-xiyysuza> <svg width="1em" height="1em" viewBox="0 0 24 24" class="w-6 h-6 text-inherit" aria-hidden="true" data-astro-cid-xiyysuza="true" data-icon="tabler:mail">   <use href="#ai:tabler:mail"></use>  </svg> </a> <button onclick="copyLinkToClipboard(this)" class="share-button copy-link-button bg-gray-600 hover:bg-gray-700 flex flex-wrap gap-3 items-center justify-center" aria-label="Copy link to post" data-astro-cid-xiyysuza> <svg width="1em" height="1em" viewBox="0 0 24 24" class="w-6 h-6 text-inherit" aria-hidden="true" data-astro-cid-xiyysuza="true" data-icon="tabler:link">   <use href="#ai:tabler:link"></use>  </svg> </button> </div> <script>
	function copyLinkToClipboard(button) {
		navigator.clipboard
			.writeText(window.location.href)
			.then(() => {
				const icon = button.querySelector("svg");
				if (icon) {
					icon.setAttribute("name", "tabler:check");
					setTimeout(() => {
						icon.setAttribute("name", "tabler:link");
					}, 2000);
				}
			})
			.catch((err) => {
				console.error("Failed to copy: ", err);
			});
	}
</script>  </div>  <div class="border-border mt-8 border-t pt-6"> <!-- normal link --><a class="button group button--outline" href="https://deployn.de/en/blog/"><svg width="1em" height="1em" class="h-4 w-4 transition-[transform] group-hover:-translate-x-1" aria-hidden="true" data-icon="tabler:chevron-left">   <symbol id="ai:tabler:chevron-left" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="m15 6l-6 6l6 6"/></symbol><use href="#ai:tabler:chevron-left"></use>  </svg>Back to all posts</a><!-- button for "submit" or other --> </div>  <div class="border-border mt-12 border-t pt-8" data-pagefind-ignore>  <noscript>Please enable JavaScript to load the comments.</noscript>  <script defer src="https://comments.deployn.de/comentario.js"></script> <comentario-comments no-fonts="true" page-id="/blog/setup-vaultwarden/"></comentario-comments> </div> </div>  <aside class="sticky top-24 col-span-1 hidden h-fit max-h-[calc(100vh-8rem)] overflow-y-auto py-8 xl:block"> <div class="space-y-4"> <h2 class="text-muted-foreground text-sm font-medium tracking-wide uppercase">Table of Contents</h2> <div class="border-border border-l-2 pl-4"> <div class="border-accent mt-1 border-l-4 py-2 pl-4 text-sm leading-tight lg:text-base" data-astro-cid-ymbpksfa> <ul class="flex flex-col gap-2" data-astro-cid-ymbpksfa> <li class="pl-3" data-astro-cid-ymbpksfa> <a href="#what-is-vaultwarden" class="toc-link hover:text-primary-600 dark:hover:text-primary-400 transition" data-astro-cid-ymbpksfa> What is Vaultwarden? </a> </li><li class="pl-3" data-astro-cid-ymbpksfa> <a href="#prerequisites" class="toc-link hover:text-primary-600 dark:hover:text-primary-400 transition" data-astro-cid-ymbpksfa> Prerequisites </a> </li><li class="pl-3" data-astro-cid-ymbpksfa> <a href="#step-1-server-preparation" class="toc-link hover:text-primary-600 dark:hover:text-primary-400 transition" data-astro-cid-ymbpksfa> Step 1: Server Preparation </a> </li><li class="pl-3" data-astro-cid-ymbpksfa> <a href="#step-2-create-docker-network" class="toc-link hover:text-primary-600 dark:hover:text-primary-400 transition" data-astro-cid-ymbpksfa> Step 2: Create Docker Network </a> </li><li class="pl-3" data-astro-cid-ymbpksfa> <a href="#step-3-create-vaultwarden-directory-structure" class="toc-link hover:text-primary-600 dark:hover:text-primary-400 transition" data-astro-cid-ymbpksfa> Step 3: Create Vaultwarden Directory Structure </a> </li><li class="pl-3" data-astro-cid-ymbpksfa> <a href="#step-4-create-docker-compose-file-for-vaultwarden" class="toc-link hover:text-primary-600 dark:hover:text-primary-400 transition" data-astro-cid-ymbpksfa> Step 4: Create Docker Compose File for Vaultwarden </a> </li><li class="pl-3" data-astro-cid-ymbpksfa> <a href="#step-5-start-vaultwarden" class="toc-link hover:text-primary-600 dark:hover:text-primary-400 transition" data-astro-cid-ymbpksfa> Step 5: Start Vaultwarden </a> </li><li class="pl-3" data-astro-cid-ymbpksfa> <a href="#step-6-configure-reverse-proxy-caddy" class="toc-link hover:text-primary-600 dark:hover:text-primary-400 transition" data-astro-cid-ymbpksfa> Step 6: Configure Reverse Proxy (Caddy) </a> </li><li class="pl-3" data-astro-cid-ymbpksfa> <a href="#step-7-first-access-and-account-creation" class="toc-link hover:text-primary-600 dark:hover:text-primary-400 transition" data-astro-cid-ymbpksfa> Step 7: First Access and Account Creation </a> </li><li class="pl-3" data-astro-cid-ymbpksfa> <a href="#step-8-secure-admin-area-and-disable-registration" class="toc-link hover:text-primary-600 dark:hover:text-primary-400 transition" data-astro-cid-ymbpksfa> Step 8: Secure Admin Area and Disable Registration </a> </li><li class="pl-3" data-astro-cid-ymbpksfa> <a href="#step-9-configure-logging-for-vaultwarden" class="toc-link hover:text-primary-600 dark:hover:text-primary-400 transition" data-astro-cid-ymbpksfa> Step 9: Configure Logging for Vaultwarden </a> </li><li class="pl-3" data-astro-cid-ymbpksfa> <a href="#step-10-set-up-fail2ban-for-additional-security" class="toc-link hover:text-primary-600 dark:hover:text-primary-400 transition" data-astro-cid-ymbpksfa> Step 10: Set Up Fail2Ban for Additional Security </a> </li><li class="pl-3" data-astro-cid-ymbpksfa> <a href="#step-11-create-fail2ban-configuration" class="toc-link hover:text-primary-600 dark:hover:text-primary-400 transition" data-astro-cid-ymbpksfa> Step 11: Create Fail2Ban Configuration </a> </li><li class="pl-3" data-astro-cid-ymbpksfa> <a href="#step-12-start-and-test-fail2ban" class="toc-link hover:text-primary-600 dark:hover:text-primary-400 transition" data-astro-cid-ymbpksfa> Step 12: Start and Test Fail2Ban </a> </li><li class="pl-3" data-astro-cid-ymbpksfa> <a href="#step-13-backup-strategy" class="toc-link hover:text-primary-600 dark:hover:text-primary-400 transition" data-astro-cid-ymbpksfa> Step 13: Backup Strategy </a> </li><li class="pl-3" data-astro-cid-ymbpksfa> <a href="#summary" class="toc-link hover:text-primary-600 dark:hover:text-primary-400 transition" data-astro-cid-ymbpksfa> Summary </a> </li> </ul> </div>  <!-- uses intersection observer to highlight which heading is in view --> <script type="module">let e,l,c;function i(t){var r=document.querySelectorAll(".toc-link");t.map(o=>{if(o.isIntersecting===!0){r.forEach(a=>a.classList.remove("toc-current"));const n=document.querySelector(`a[href="#${o.target.id}"].toc-link`);n&&n.classList.add("toc-current")}})}function s(){e=document.querySelector(".prose"),e!==null&&(c=e.querySelectorAll(":scope > h1, :scope > h2, :scope > h3"));let t={root:null,rootMargin:"0px",threshold:[1]};l=new IntersectionObserver(i,t),e!==null&&c.forEach(r=>{l.observe(r)})}s();document.addEventListener("astro:after-swap",s);</script> </div> </div> </aside> </div> </div> </article>  </main> <footer id="page-footer" class="border-border/50 bg-background/50 mt-auto border-t py-6 backdrop-blur-sm">  <div class="site-container flex flex-col items-center justify-between gap-6 text-sm sm:flex-row sm:gap-0">  <nav class="flex flex-wrap justify-center gap-x-5 gap-y-2 sm:justify-start">  <a href="https://deployn.de/en/blog/" class="text-foreground/70 hover:text-primary transition-colors"> 
Blog
</a> <a href="https://deployn.de/en/contact/" class="text-foreground/70 hover:text-primary transition-colors">  Contact </a> <a href="https://deployn.de/en/impressum/" class="text-foreground/70 hover:text-primary transition-colors">  Imprint </a> <a href="https://deployn.de/en/datenschutz/" class="text-foreground/70 hover:text-primary transition-colors">  Privacy </a> </nav> <div class="text-foreground/60 text-center sm:text-right">  <div>&copy; 2025 <span class="font-medium">Deployn</span></div> <div class="mt-1 text-xs opacity-70">Built at <time datetime="2025-07-16T16:13:37.000Z"> Jul 16, 2025, 4:13 PM </time></div>  </div> </div> </footer> <div x-cloak x-data="{ open: !localStorage.getItem('survey2025BannerDismissed') }" x-init="if (open === false) { return; }" x-show="open" x-transition:enter="transition ease-out duration-300" x-transition:enter-start="opacity-0 translate-y-4" x-transition:enter-end="opacity-100 translate-y-0" x-transition:leave="transition ease-in duration-200" x-transition:leave-start="opacity-100 translate-y-0" x-transition:leave-end="opacity-0 translate-y-4" role="alert" class="fixed bottom-0 left-1/2 z-[59] mx-auto w-full -translate-x-1/2 transform p-6 sm:max-w-4xl"> <div class="rounded-xl border border-gray-200 bg-white p-4 shadow-sm dark:border-gray-700 dark:bg-gray-800"> <div class="flex flex-col gap-4 sm:flex-row sm:items-center sm:justify-between sm:gap-x-6"> <p class="text-sm text-gray-700 dark:text-gray-300"> <span>Help shape the self-hosting community! Participate in the 2025 survey.</span> </p> <div class="flex items-center gap-3"> <a href="https://survey.deployn.de/self-hosted-2025/" target="_blank" rel="noopener noreferrer" class="bg-primary-600 hover:bg-primary-700 focus:ring-primary-500 inline-flex items-center justify-center rounded-lg px-4 py-2 text-sm font-medium text-white focus:ring-2 focus:ring-offset-2 focus:outline-none dark:focus:ring-offset-gray-800"> Take survey </a> <button type="button" @click="localStorage.setItem('survey2025BannerDismissed', 'true'); open = false;" class="inline-flex rounded-full bg-gray-200 p-2 text-gray-500 hover:bg-gray-300 focus:ring-2 focus:ring-gray-600 focus:ring-offset-2 focus:ring-offset-gray-50 focus:outline-none dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600"> <span class="sr-only">Dismiss</span> <svg class="h-4 w-4" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"> <path d="M0.92524 0.687069C1.126 0.486219 1.39823 0.373377 1.68209 0.373377C1.96597 0.373377 2.2382 0.486219 2.43894 0.687069L8.10514 6.35813L13.7714 0.687069C13.8701 0.584748 13.9882 0.503105 14.1188 0.446962C14.2494 0.39082 14.3899 0.361248 14.5321 0.360026C14.6742 0.358783 14.8151 0.38589 14.9468 0.439762C15.0782 0.493633 15.1977 0.573197 15.2983 0.673783C15.3987 0.774389 15.4784 0.894026 15.5321 1.02568C15.5859 1.15736 15.6131 1.29845 15.6118 1.44071C15.6105 1.58297 15.5809 1.72357 15.5248 1.85428C15.4688 1.98499 15.3872 2.10324 15.2851 2.20206L9.61883 7.87312L15.2851 13.5441C15.4801 13.7462 15.588 14.0168 15.5854 14.2977C15.5831 14.5787 15.4705 14.8474 15.272 15.046C15.0735 15.2449 14.805 15.3574 14.5244 15.3599C14.2437 15.3623 13.9733 15.2543 13.7714 15.0591L8.10514 9.38812L2.43894 15.0591C2.23704 15.2543 1.96663 15.3623 1.68594 15.3599C1.40526 15.3574 1.13677 15.2449 0.938279 15.046C0.739807 14.8474 0.627232 14.5787 0.624791 14.2977C0.62235 14.0168 0.730236 13.7462 0.92524 13.5441L6.59144 7.87312L0.92524 2.20206C0.724562 2.00115 0.611816 1.72867 0.611816 1.44457C0.611816 1.16047 0.724562 0.887983 0.92524 0.687069Z" fill="currentColor"></path> </svg> </button> </div> </div> </div> </div> <div x-cloak x-data="{ open: !localStorage.getItem('cookieBannerDismissed') }" x-init="if (open === false) { return; }" x-show="open" x-transition:enter="transition ease-out duration-200" x-transition:enter-start="opacity-0 scale-125" x-transition:enter-end="opacity-100 scale-100" x-transition:leave="transition ease-in duration-100" x-transition:leave-start="opacity-100 scale-100" x-transition:leave-end="opacity-0 scale-125" role="document" class="fixed bottom-0 left-1/2 z-[60] mx-auto w-full -translate-x-1/2 transform p-6 sm:max-w-4xl"> <!-- Card --> <div class="rounded-xl border border-gray-200 bg-white p-4 shadow-sm dark:border-gray-700 dark:bg-gray-800"> <div class="flex items-center justify-between gap-x-5 sm:gap-x-10"> <div class="text-sm text-gray-600 dark:text-gray-400"> <span>This website uses cookies. These are necessary for the functionality of the website. You can find more information in the</span> <a class="inline-flex items-center gap-x-1.5 font-medium text-secondary-900 decoration-2 hover:underline dark:text-secondary-100" href="https://deployn.de/datenschutz/">privacy policy</a> </div> <button type="button" @click="localStorage.setItem('cookieBannerDismissed', 'true'); open = false;" class="inline-flex rounded-full bg-gray-200 p-3 text-gray-500 hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-600 focus:ring-offset-2 focus:ring-offset-gray-50 dark:bg-gray-700 dark:text-gray-400 dark:hover:bg-gray-600" data-hs-remove-element="#cookies-simple-with-dismiss-button"> <span class="sr-only">Dismiss</span> <svg class="h-3 w-3" width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"> <path d="M0.92524 0.687069C1.126 0.486219 1.39823 0.373377 1.68209 0.373377C1.96597 0.373377 2.2382 0.486219 2.43894 0.687069L8.10514 6.35813L13.7714 0.687069C13.8701 0.584748 13.9882 0.503105 14.1188 0.446962C14.2494 0.39082 14.3899 0.361248 14.5321 0.360026C14.6742 0.358783 14.8151 0.38589 14.9468 0.439762C15.0782 0.493633 15.1977 0.573197 15.2983 0.673783C15.3987 0.774389 15.4784 0.894026 15.5321 1.02568C15.5859 1.15736 15.6131 1.29845 15.6118 1.44071C15.6105 1.58297 15.5809 1.72357 15.5248 1.85428C15.4688 1.98499 15.3872 2.10324 15.2851 2.20206L9.61883 7.87312L15.2851 13.5441C15.4801 13.7462 15.588 14.0168 15.5854 14.2977C15.5831 14.5787 15.4705 14.8474 15.272 15.046C15.0735 15.2449 14.805 15.3574 14.5244 15.3599C14.2437 15.3623 13.9733 15.2543 13.7714 15.0591L8.10514 9.38812L2.43894 15.0591C2.23704 15.2543 1.96663 15.3623 1.68594 15.3599C1.40526 15.3574 1.13677 15.2449 0.938279 15.046C0.739807 14.8474 0.627232 14.5787 0.624791 14.2977C0.62235 14.0168 0.730236 13.7462 0.92524 13.5441L6.59144 7.87312L0.92524 2.20206C0.724562 2.00115 0.611816 1.72867 0.611816 1.44457C0.611816 1.16047 0.724562 0.887983 0.92524 0.687069Z" fill="currentColor"></path> </svg> </button> </div> </div> </div> </body>
<!-- Mirrored from deployn.de/en/blog/setup-vaultwarden/ by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 18 Jul 2025 17:41:09 GMT -->
</html>