<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Weather - Grandma's Media Center</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .header h1 {
            font-size: 3em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .back-button {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 1.5em;
            border-radius: 15px;
            cursor: pointer;
            margin-bottom: 20px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            text-decoration: none;
            display: inline-block;
        }
        
        .back-button:hover {
            background: #ff5252;
            transform: translateY(-2px);
        }
        
        .weather-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .weather-card {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .current-weather {
            grid-column: 1 / -1;
        }
        
        .temperature {
            font-size: 4em;
            font-weight: bold;
            margin: 20px 0;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .weather-desc {
            font-size: 1.5em;
            margin-bottom: 20px;
            text-transform: capitalize;
        }
        
        .weather-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        
        .detail-item {
            background: rgba(255, 255, 255, 0.1);
            padding: 15px;
            border-radius: 10px;
            text-align: center;
        }
        
        .detail-label {
            font-size: 0.9em;
            opacity: 0.8;
            margin-bottom: 5px;
        }
        
        .detail-value {
            font-size: 1.2em;
            font-weight: bold;
        }
        
        .forecast-card h3 {
            font-size: 1.8em;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .forecast-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .forecast-item:last-child {
            border-bottom: none;
        }
        
        .forecast-day {
            font-weight: bold;
            font-size: 1.1em;
        }
        
        .forecast-temps {
            font-size: 1.1em;
        }
        
        .radar-container {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            margin-top: 20px;
        }
        
        .radar-container h3 {
            font-size: 2em;
            margin-bottom: 20px;
        }
        
        .radar-iframe {
            width: 100%;
            height: 500px;
            border: none;
            border-radius: 15px;
            background: white;
        }
        
        .error-message {
            text-align: center;
            font-size: 1.5em;
            color: #ffcdd2;
            background: rgba(244, 67, 54, 0.2);
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
        }
        
        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }
            
            .temperature {
                font-size: 3em;
            }
            
            .weather-grid {
                grid-template-columns: 1fr;
            }
            
            .radar-iframe {
                height: 400px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üå§Ô∏è Weather Dashboard</h1>
            <a href="/" class="back-button">üè† Back to Home</a>
        </div>
        
        {% if error %}
            <div class="error-message">
                ‚ö†Ô∏è Weather information is currently unavailable: {{ error }}
            </div>
        {% else %}
            <div class="weather-grid">
                {% if current_weather %}
                    <div class="weather-card current-weather">
                        <h2>Current Weather</h2>
                        <div class="temperature">{{ current_weather.temp }}¬∞F</div>
                        <div class="weather-desc">{{ current_weather.description }}</div>
                        
                        <div class="weather-details">
                            <div class="detail-item">
                                <div class="detail-label">Feels Like</div>
                                <div class="detail-value">{{ current_weather.feels_like }}¬∞F</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Humidity</div>
                                <div class="detail-value">{{ current_weather.humidity }}%</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Wind</div>
                                <div class="detail-value">{{ current_weather.wind_speed }} mph</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Pressure</div>
                                <div class="detail-value">{{ current_weather.pressure }} hPa</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">Visibility</div>
                                <div class="detail-value">{{ current_weather.visibility }} mi</div>
                            </div>
                            <div class="detail-item">
                                <div class="detail-label">UV Index</div>
                                <div class="detail-value">{{ current_weather.uvi }}</div>
                            </div>
                        </div>
                    </div>
                {% endif %}
                
                {% if forecast %}
                    <div class="weather-card forecast-card">
                        <h3>üìÖ 5-Day Forecast</h3>
                        {% for day in forecast %}
                            <div class="forecast-item">
                                <div class="forecast-day">{{ day.date }}</div>
                                <div class="forecast-desc">{{ day.description }}</div>
                                <div class="forecast-temps">
                                    <strong>{{ day.temp_max }}¬∞</strong> / {{ day.temp_min }}¬∞
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                {% endif %}
                
                {% if alerts %}
                    <div class="weather-card">
                        <h3>‚ö†Ô∏è Weather Alerts</h3>
                        {% for alert in alerts %}
                            <div class="alert-item">
                                <strong>{{ alert.event }}</strong>
                                <p>{{ alert.description }}</p>
                                <small>{{ alert.start }} - {{ alert.end }}</small>
                            </div>
                        {% endfor %}
                    </div>
                {% endif %}
            </div>
            
            <!-- Weather Radar -->
            <div class="radar-container">
                <h3>üå¶Ô∏è Interactive Weather Radar</h3>
                <iframe 
                    class="radar-iframe"
                    src="https://embed.windy.com/embed2.html?lat={{ lat | default('40.7128') }}&lon={{ lon | default('-74.0060') }}&detailLat={{ lat | default('40.7128') }}&detailLon={{ lon | default('-74.0060') }}&width=650&height=450&zoom=8&level=surface&overlay=radar&product=radar&menu=&message=true&marker=&calendar=now&pressure=&type=map&location=coordinates&detail=&metricWind=default&metricTemp=default&radarRange=-1"
                    frameborder="0">
                </iframe>
            </div>
        {% endif %}
    </div>
</body>
</html>
