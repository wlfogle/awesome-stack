"use strict";!function(){var n=self,y="undefined"!=typeof chrome&&chrome||{},e=y.runtime.getURL("PATH/").replace("/PATH/",""),_=e.startsWith("safari-web-extension://"),t=!_&&e.startsWith("moz-extension://"),i=!_&&!t;function p(e,r){return new Promise(function(t,n){y.notifications.create(e,r,function(){var e=y.runtime.lastError;e?n(e):t()})})}function r(n){try{y.runtime.connectNative("application.id").onMessage.addListener(function(e){var t=e.name,e=function(e){try{return JSON.parse(e.data)}catch(e){return null}}(e.userInfo);n(t,e)})}catch(e){}}var e=y.sidebarAction||"object"==typeof opr&&opr.sidebarAction,m=y.action||y.browserAction||y.pageAction||e;function o(o){return new Promise(function(n,r){function e(e){var t=y.runtime.lastError;t?r(t):n(e)}try{o?m.openPopup(o,e):m.openPopup(e)}catch(e){var t=o?m.openPopup(o):m.openPopup();n(t)}})}function s(e){var t;return m.openPopup?(t=o(e),e?t.catch(function(){return o()}):t):Promise.reject(new Error("API missing"))}function h(e){m.setPopup({popup:e})}function b(){var e;h(t?null:((e=y.runtime.getManifest()).action||e.browser_action||e.page_action||{}).default_popup||"")}var c=y.tabs&&y.tabs.TAB_ID_NONE||-1;function u(o){return new Promise(function(n,r){y.tabs.query(o,function(e){var t=y.runtime.lastError;t?r(t):Array.isArray(e)?_&&o&&o.url?(t=e.filter(function(e){return e.url}),n(t)):n(e):r(new Error("No array returned"))}),setTimeout(n,2e3)})}function l(e){return"number"==typeof(e=e&&e.id)?e:c}function f(a){return new Promise(function(n,r){function o(e){var t=e.message||"";"openerTabId"in a&&-1!==t.indexOf("openerTabId")?(delete a.openerTabId,n(f(a))):i&&-1!==t.indexOf("Saved groups are not editable")?n():r(e)}try{y.tabs.create(a,function(e){var t=y.runtime.lastError;t?o(t):n(e)})}catch(e){o(e)}})}function d(e){n.open(e,"_blank","noopener")}function g(t){try{n.top.location.href=t}catch(e){d(t)}}function v(t,e){var o,a,n="number"==typeof(e=e)&&e!==c?e:null;return o=n,a={url:t},new Promise(function(n,r){y.tabs.update(o,a,function(e){var t=y.runtime.lastError;t?r(t):n(e)})}).catch(function(){if(null===n)return u({active:!0,currentWindow:!0}).then(function(e){return e[0]},function(){return null}).then(function(e){e=l(e);if(e!==c)return v(t,e);g(t)});g(t)})}function w(e,t,n,a){var r={url:e},i=(!1===t&&n&&(r.active=!1),l(a));return i!==c&&(r.openerTabId=i,r.index=a.index+1),f(r).then(function(e){var t,n,r,o;return i!==c&&(t=e,n=a,y.tabs.group)&&(r=l(t))!==c&&(o=n.groupId,t.groupId!==o)&&y.tabs.group({groupId:o,tabIds:r},function(){y.runtime.lastError||(t.groupId=o)}),e},function(){d(e)})}function I(e,t,n,r,o){if(!e)return Promise.reject(new Error("Missing URL"));if(!n){var a;if(t)return a=Boolean(r&&r.incognito),i={incognito:a,url:e},new Promise(function(n,r){y.windows.create(i,function(e){var t=y.runtime.lastError;t?r(t):n(e)})}).catch(function(){return w(e,t,n,r)});if(!1===n)return v(e,o)}var i;return w(e,t,n,r)}var a,S=!0;try{var A=y.i18n.getMessage("@@ui_locale");"string"==typeof A&&"und"!==A&&(a=A.replace("_","-"))}catch(e){S=!1}if(!a)try{var P=y.runtime.getManifest().default_locale;"string"==typeof P&&P.replace("_","-")}catch(e){}function j(e,t){return e&&S&&y.i18n.getMessage(e)||t||""}function L(){}function x(e){e=e.split(".");return e[0]+"."+e[1]}function M(r){var o,a=y.runtime.getManifest(),i=a.version,e=a.browser_action||a.action,t=e&&e.default_popup,e=(r.origin||"https://apps.jeurissen.co")+"/"+(r.websitePath||"")+"/",s=e+"installed",n=e+"whatsnew?installed=1",c=r.updateBadge,u=864e5*(r.passiveActionButton?1.5:4.5);function l(){o&&(o=null,I(n),y.storage.local.remove("cj_landing_lastupdated"),r.onExecute&&r.onExecute(),c)&&(m.onClicked.removeListener(l),t&&b(),!0===c)&&m.setBadgeText({text:""})}function f(){var t,n,e,r="cj_landing_update_notification";t=r,n={requireInteraction:!0,type:"basic",iconUrl:(e=(e=a).icons)?e[160]||e[80]||e[128]||e[48]||e[Object.keys(e)[0]]:null,message:j("cj_i18n_06287","Click to view changelog"),title:j("cj_i18n_06288","{APP_NAME} has been updated").replace("{APP_NAME}",a.name)},p(t,n).catch(function(e){e=e&&e.message||"";if("requireInteraction"in n&&-1!==e.indexOf("requireInteraction"))return delete n.requireInteraction,p(t,n)}),y.notifications.onClicked.addListener(function(e){e===r&&(l(),y.notifications.clear(r))})}function d(){c&&(t&&h(""),!0===c)&&(m.setBadgeBackgroundColor({color:"#EA4335"}),m.setBadgeText({text:_?"*":"âœµ"})),r.onUpdateAvailable&&r.onUpdateAvailable()}function g(){function e(){l(),y.windows.onFocusChanged.removeListener(e),y.tabs.onCreated.removeListener(e)}y.windows.onFocusChanged.addListener(e),y.tabs.onCreated.addListener(e)}y.runtime.setUninstallURL(e+"uninstalled"),y.storage.local.get(["cj_landing_lastupdated","cj_landing_versionnumber"],function(e){var t,n=Date.now();o=e.cj_landing_lastupdated,"string"!=typeof(e=e.cj_landing_versionnumber)?I(s):o||(t=x(e),x(i)!==t&&(o=n,y.storage.local.set({cj_landing_lastupdated:n}))),o&&!r.noUpdateNotice&&(r.useNotification&&y.notifications?f():(!c||(t=n,d(),u<t-o))&&g(),r.handleTrigger)&&y.runtime.onMessage.addListener(function e(t,n){return n.id===y.runtime.id&&"cjeLandingOpen"===(t&&t.method)&&(l(),y.runtime.onMessage.removeListener(e)),!1}),e!==i&&y.storage.local.set({cj_landing_versionnumber:i})}),m.onClicked.addListener(l),y.runtime.onStartup.addListener(L),y.runtime.onInstalled.addListener(L)}function O(e,t,n){var r;return I(y.runtime.getURL((r=y.runtime.getManifest()).options_page||(r.options_ui||{}).page||"/views/options.html"),e,t,n)}function k(e,t,n){if(e||t||_)return O(e,t,n);new Promise(function(e,t){y.runtime.openOptionsPage(function(){(y.runtime.lastError?t:e)()})}).catch(function(){return O(e,t,n)})}var C,B={3:"6",13:"202",20:"439",22:"21",38:"37",52:"421",69:"780",74:"210",76:"1230",77:"1138",82:"1605",83:"39",84:"1004",85:"1601",90:"559",92:"823",130:"405",135:"901",165:"58",170:"1605",172:"23",200:"163",203:"359",207:"521",216:"157",217:"1695",218:"559",222:"1305",225:"49",236:"521",252:"666",259:"1740",273:"101",280:"1188",285:"6",294:"147",295:"59",296:"129",304:"70",305:"306",310:"45",311:"559",317:"89",320:"733",330:"898",336:"1743",339:"237",343:"1605",347:"1773",348:"1704",349:"602",351:"144",352:"1500",355:"550",358:"813",369:"11",372:"750",378:"1674",412:"1475",415:"256",417:"768",420:"1692",424:"693",425:"1347",431:"256",434:"73",436:"240",441:"1704",444:"1704",445:"215",450:"1720",451:"1409",455:"665",456:"1069",459:"1373",468:"1373",471:"1499",479:"1605",481:"484",483:"484",486:"145",487:"1158",488:"1551",493:"126",494:"1373",496:"1119",500:"499",505:"1513",518:"687",519:"1605",526:"1286",531:"234",540:"561",541:"1069",542:"59",546:"1286",547:"1245",549:"740",558:"718",577:"240",579:"395",582:"30",585:"39",600:"442",605:"1773",606:"612",609:"1726",611:"687",613:"1609",614:"1609",615:"559",616:"856",620:"757",623:"129",634:"633",637:"1776",641:"1732",642:"395",644:"925",649:"1782",650:"438",651:"1431",652:"1430",653:"1720",670:"856",672:"237",673:"1117",674:"626",675:"661",678:"1692",686:"1704",688:"261",699:"18",705:"269",707:"657",710:"1478",712:"1617",715:"780",721:"234",722:"234",723:"234",724:"234",725:"726",729:"1388",731:"158",741:"881",742:"657",743:"657",751:"750",752:"750",756:"97",764:"1069",775:"1716",783:"321",791:"790",792:"484",799:"590",807:"1669",817:"32",819:"1348",820:"1348",828:"1745",829:"1069",830:"1069",833:"1479",838:"244",846:"1682",847:"242",855:"1669",857:"856",859:"1571",861:"353",862:"353",869:"35",874:"604",875:"604",876:"604",893:"1336",897:"1720",900:"1618",909:"559",910:"1668",917:"1337",918:"687",924:"58",932:"1339",941:"740",947:"946",949:"23",950:"367",951:"11",952:"367",953:"367",956:"37",962:"1551",971:"1365",990:"49",993:"730",1e3:"1506",1001:"237",1010:"687",1011:"1666",1018:"45",1020:"1015",1031:"648",1032:"1296",1040:"1216",1042:"987",1045:"987",1056:"1131",1059:"559",1063:"1475",1066:"1069",1067:"1069",1076:"260",1078:"109",1080:"1069",1082:"63",1103:"1756",1107:"901",1108:"901",1109:"271",1110:"271",1111:"271",1116:"901",1120:"1614",1127:"1007",1129:"140",1130:"97",1144:"129",1145:"439",1147:"1473",1148:"1610",1156:"687",1160:"594",1164:"1745",1165:"16",1177:"787",1178:"61",1180:"61",1187:"1015",1189:"89",1191:"559",1193:"559",1194:"1015",1213:"129",1229:"1477",1247:"11",1249:"1245",1261:"908",1265:"1781",1271:"1666",1277:"1616",1279:"1729",1280:"1729",1292:"338",1293:"1283",1294:"1283",1295:"79",1300:"101",1301:"1281",1303:"1007",1307:"42",1308:"1007",1309:"1007",1312:"711",1319:"244",1321:"1007",1323:"1709",1326:"1320",1329:"30",1332:"1007",1334:"1667",1335:"1333",1342:"908",1346:"1041",1359:"779",1360:"901",1383:"901",1385:"901",1402:"1741",1408:"1327",1411:"1007",1416:"639",1418:"1777",1441:"73",1469:"1733",1480:"1007",1481:"1007",1482:"1007",1492:"1618",1504:"1630",1514:"1727",1522:"907",1529:"1096",1546:"31",1567:"109",1586:"1578",1648:"288"},T=i,D=["customServicesDatabase","customShortcutsDatabase1","customShortcutsDatabase2","customShortcutsDatabase3","autoListRemoved","displayMarketplaceApps","displayMode","freezeCustomisation","gbwaConfig","hideLabel","hideSuggestions","iconBreak","noFocusActiveTab","noFocusTab","openInCurrentTab","openInNewTabChrome","shortcutIconSize","showLaunchbox","showSettings","toolbarIcon","toolbarIconDarkMode","appDarkMode","userList"];function N(i){var t=algBasics.cachePrefix+"iconDataCache";browserStorage.local.getItem(t).then(function(e){for(var n=[],r={},o=(e&&"object"==typeof e&&(r=e),Object.keys(i)),a=0;a<o.length;a++)!function(){var t=o[a];if(r[t])return;var e=i[t]||{},e=algBasics.getUrlIcon(e.url,e.iconUrl).then(function(e){e&&"object"==typeof e&&(r[t]=e)},function(){});n.push(e)}();return setTimeout(function(){browserStorage.local.setItem(t,r)},1e3),Promise.all(n).then(function(){browserStorage.local.setItem(t,r)})})}function U(v){browserStorage.sync.get().then(function(e){var t=v||JSON.parse(JSON.stringify(e)),n=(t.toolbarIcon&&-1!==algBasics.customActionIcons.indexOf(t.toolbarIcon)||delete t.toolbarIcon,t.userList);if(Array.isArray(n)&&0<n.length){var r=algBasics.getShortcutsList(),o=algBasics.joinCustomShortcutsDatabase([e,v]),n=function(e,t,n){for(var r=0===Object.keys(n).length,o=[],a=0;a<e.length;a++){var i=e[a],i=B[i]||i;-1===o.indexOf(i)&&(t[i]||r||n[i])&&o.push(i)}return o}(t.userList,r,o);t.userList=n;for(var a=Object.keys(o),i=0;i<a.length;i++){var s,c=a[i];-1===n.indexOf(c)?delete o[c]:(s=algBasics.cleanCustomShortcutData(o[c]),o[c]=s)}!1!==navigator.onLine&&N(o),algBasics.splitCustomShortcutsDatabase(o,t),y.storage.local.set({algCustomShortcutsDatabase:o}),delete t.customServicesDatabase}else{r=algBasics.getOgsShortcuts({}).then(function(e){if(!Array.isArray(e))return null;for(var t,n=algBasics.gbIdToShortcutIdMap,r=[],o=e[0],a=0;a<o.length;a++)(t=(t=o[a][1][0].toString())&&n[t])&&(!_||"70"!==t&&"101"!==t)&&r.push(t);return r}).catch(function(){return null}).then(function(e){Array.isArray(e)&&(n=e)});[].push(r)}!1===t.alwaysTab&&(t.openInCurrentTab=!0),delete t.alwaysTab;for(var u=Object.keys(t),l=0;l<u.length;l++){var f=u[l];-1===D.indexOf(f)&&delete t[f]}for(var d={},g=[],u=Object.keys(t),p=Object.keys(e).concat(u),m=0;m<p.length;m++){var h,b=p[m];b in t?(h=t[b],JSON.stringify(h)!==JSON.stringify(e[b])&&(d[b]=h)):g.push(b)}return(0<Object.keys(d).length?browserStorage.sync.set(d):Promise.resolve()).then(function(){if(0<g.length&&!_&&!T)return browserStorage.sync.remove(g)}).then(function(){return t},function(){return t})})}function E(e){for(var t=function(){var r=e[n];if(!r)return 1;u({url:r.matches}).then(function(e){for(var t=0;t<e.length;t++){var n=e[t];n.discarded||"unloaded"!==n.status&&!function(r,e){var t,n=e.css,o=e.js,a=e.all_frames,i=e.run_at;function s(e,t){var n=t.shift();n&&y.tabs[e](r,{allFrames:a,file:n,runAt:i},function(){s(e,t)})}y.scripting?(t={allFrames:a,tabId:r},n&&y.scripting.insertCSS({files:n,target:t}),o&&(t={files:o,target:t,injectImmediately:"document_start"===i},(e=e.world)&&(t.world=e),y.scripting.executeScript(t))):(n&&s("insertCSS",n),o&&s("executeScript",o))}(n.id,r)}})},n=0;n<e.length;n++)t()}function F(e){var t,n;i&&(t=y.runtime.getManifest().content_scripts||[],0!==(n=Array.prototype.concat(t,e)).length)&&(y.runtime.onInstalled.addListener(function(){E(n)}),y.permissions.onAdded.addListener(function(e){e=e&&e.origins;Array.isArray(e)&&0!==e.length&&E(n)}))}function W(){browserStorage.sync.get(["toolbarIcon","toolbarIconDarkMode"]).then(function(e){var t=_?"function"==typeof matchMedia&&matchMedia("(prefers-color-scheme:dark)").matches:e.toolbarIconDarkMode;algBasics.setActionIcon(e.toolbarIcon,t)})}function q(e){e(),y.runtime.onStartup&&y.runtime.onStartup.addListener(e)}function J(){_||y.storage.local.get(null,function(e){e=Object.keys(e).filter(function(e){return"legacyExtDisplayed202404"!==e&&"algCustomShortcutsDatabase"!==e&&"workspaceBannerDisplayed"!==e&&"__sync_fallback__"!==e&&!e.startsWith("cj_landing_")&&!e.startsWith("__sync_storage__")&&!e.startsWith(algBasics.cachePrefix)});0<e.length&&y.storage.local.remove(e)}),U()}"undefined"!=typeof document&&(document.body.textContent=""),q(W),M({handleTrigger:!0,noUpdateNotice:_,updateBadge:!0,websitePath:"g-app-launcher"}),F(),J(),C=t,y.runtime.onMessage.addListener(function(e,t,n){if(t.id===y.runtime.id){var r=e&&e.method;if(r){var o,a,i,t=t.tab;if(C&&e.forward&&t&&e.tabId===t.id)e.forward=!1,a=(e=e).tabId,i=y.tabs&&y.tabs.sendMessage,(0===a||0<a)&&i?y.tabs.sendMessage(a,e,{frameId:e.frameId},o):y.runtime.sendMessage(e,o);else{if("openActionPopup"===r)return s().then(function(e){n("success",e)},function(e){n("error",e)}),!0;"getCurrentTab"===r&&n(t)}}}return!1}),_&&r(function(e,t){"activateExtension"===e?s():"openExtensionPreferences"===e?k():"openUrl"===e&&I(t)})}();